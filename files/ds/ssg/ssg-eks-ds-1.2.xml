<?xml version="1.0" encoding="utf-8"?>
<ds:data-stream-collection xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog" xmlns:cpe-dict="http://cpe.mitre.org/dictionary/2.0" xmlns:cpe-lang="http://cpe.mitre.org/language/2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:ds="http://scap.nist.gov/schema/scap/source/1.2" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:ind="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:ocil="http://scap.nist.gov/schema/ocil/2.0" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:unix="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:xccdf-1.2="http://checklists.nist.gov/xccdf/1.2" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="scap_org.open-scap_collection_from_xccdf_ssg-eks-xccdf.xml" schematron-version="1.2">
  <ds:data-stream id="scap_org.open-scap_datastream_from_xccdf_ssg-eks-xccdf.xml" scap-version="1.2" use-case="OTHER">
    <ds:dictionaries>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-eks-cpe-dictionary.xml" xlink:href="#scap_org.open-scap_comp_ssg-eks-cpe-dictionary.xml">
        <cat:catalog>
          <cat:uri name="ssg-eks-cpe-oval.xml" uri="#scap_org.open-scap_cref_ssg-eks-cpe-oval.xml"/>
        </cat:catalog>
      </ds:component-ref>
    </ds:dictionaries>
    <ds:checklists>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-eks-xccdf.xml" xlink:href="#scap_org.open-scap_comp_ssg-eks-xccdf.xml">
        <cat:catalog>
          <cat:uri name="ssg-eks-oval.xml" uri="#scap_org.open-scap_cref_ssg-eks-oval.xml"/>
          <cat:uri name="ssg-eks-ocil.xml" uri="#scap_org.open-scap_cref_ssg-eks-ocil.xml"/>
          <cat:uri name="ssg-eks-cpe-oval.xml" uri="#scap_org.open-scap_cref_ssg-eks-cpe-oval.xml"/>
        </cat:catalog>
      </ds:component-ref>
    </ds:checklists>
    <ds:checks>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-eks-oval.xml" xlink:href="#scap_org.open-scap_comp_ssg-eks-oval.xml"/>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-eks-ocil.xml" xlink:href="#scap_org.open-scap_comp_ssg-eks-ocil.xml"/>
      <ds:component-ref id="scap_org.open-scap_cref_ssg-eks-cpe-oval.xml" xlink:href="#scap_org.open-scap_comp_ssg-eks-cpe-oval.xml"/>
    </ds:checks>
  </ds:data-stream>
  <ds:component id="scap_org.open-scap_comp_ssg-eks-cpe-dictionary.xml" timestamp="2024-05-16T18:06:55">
    <cpe-dict:cpe-list xsi:schemaLocation="http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd">
      <cpe-dict:cpe-item name="cpe:/a:amazon:elastic_kubernetes_service:1">
        <cpe-dict:title xml:lang="en-us">Amazon Elastic Kubernetes Service</cpe-dict:title>
        <cpe-dict:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-eks-cpe-oval.xml">oval:ssg-installed_app_is_eks:def:1</cpe-dict:check>
      </cpe-dict:cpe-item>
      <cpe-dict:cpe-item name="cpe:/a:amazon:elastic_kubernetes_service_node:1.21">
        <cpe-dict:title xml:lang="en-us">Amazon Elastic Kubernetes Service 1.21</cpe-dict:title>
        <cpe-dict:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-eks-cpe-oval.xml">oval:ssg-installed_app_is_eks_1_21:def:1</cpe-dict:check>
      </cpe-dict:cpe-item>
      <cpe-dict:cpe-item name="cpe:/o:amazon:elastic_kubernetes_service_node:1">
        <cpe-dict:title xml:lang="en-us">Amazon Elastic Kubernetes Service Node</cpe-dict:title>
        <cpe-dict:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-eks-cpe-oval.xml">oval:ssg-installed_app_is_eks_node:def:1</cpe-dict:check>
      </cpe-dict:cpe-item>
    </cpe-dict:cpe-list>
  </ds:component>
  <ds:component id="scap_org.open-scap_comp_ssg-eks-xccdf.xml" timestamp="2024-05-16T18:06:55">
    <xccdf-1.2:Benchmark id="xccdf_org.ssgproject.content_benchmark_EKS" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 xccdf-1.2.xsd" style="SCAP_1.2" resolved="true" xml:lang="en-US">
      <xccdf-1.2:status date="2024-05-16">draft</xccdf-1.2:status>
      <xccdf-1.2:title>Guide to the Secure Configuration of Amazon Elastic Kubernetes Service</xccdf-1.2:title>
      <xccdf-1.2:description>This guide presents a catalog of security-relevant
configuration settings for Amazon Elastic Kubernetes Service. It is a rendering of
content structured in the eXtensible Configuration Checklist Description Format (XCCDF)
in order to support security automation.  The SCAP content is
is available in the <html:code>scap-security-guide</html:code> package which is developed at

    <html:a href="https://www.open-scap.org/security-policies/scap-security-guide">https://www.open-scap.org/security-policies/scap-security-guide</html:a>.
<html:br/>
    <html:br/>
Providing system administrators with such guidance informs them how to securely
configure systems under their control in a variety of network roles. Policy
makers and baseline creators can use this catalog of settings, with its
associated references to higher-level security control catalogs, in order to
assist them in security baseline creation. This guide is a <html:em>catalog, not a
checklist</html:em>, and satisfaction of every item is not likely to be possible or
sensible in many operational scenarios. However, the XCCDF format enables
granular selection and adjustment of settings, and their association with OVAL
and OCIL content provides an automated checking capability. Transformations of
this document, and its associated automated checking content, are capable of
providing baselines that meet a diverse set of policy objectives. Some example
XCCDF <html:em>Profiles</html:em>, which are selections of items that form checklists and
can be used as baselines, are available with this guide. They can be
processed, in an automated fashion, with tools that support the Security
Content Automation Protocol (SCAP). The NIST National Checklist Program (NCP),
which provides required settings for the United States Government, is one example
of a baseline created from this guidance.
</xccdf-1.2:description>
      <xccdf-1.2:notice id="terms_of_use">Do not attempt to implement any of the settings in
this guide without first testing them in a non-operational environment. The
creators of this guidance assume no responsibility whatsoever for its use by
other parties, and makes no guarantees, expressed or implied, about its
quality, reliability, or any other characteristic.
</xccdf-1.2:notice>
      <xccdf-1.2:front-matter>The ComplianceAsCode Project<html:br/>
    <html:a href="https://www.open-scap.org/security-policies/scap-security-guide">https://www.open-scap.org/security-policies/scap-security-guide</html:a>
   </xccdf-1.2:front-matter>
      <xccdf-1.2:rear-matter>Red Hat and Red Hat Enterprise Linux are either registered
trademarks or trademarks of Red Hat, Inc. in the United States and other
countries. All other names are registered trademarks or trademarks of their
respective companies.</xccdf-1.2:rear-matter>
      <xccdf-1.2:reference href="https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf">anssi</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=application-servers">app-srg</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">app-srg-ctr</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/International/bsi_it_gs_comp_2022.pdf">bsi</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">cis</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.cisecurity.org/controls/">cis-csc</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf">cjis</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.isaca.org/resources/cobit">cobit5</xccdf-1.2:reference>
      <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf">cui</xccdf-1.2:reference>
      <xccdf-1.2:reference href="not_officially_available">dcid</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://public.cyber.mil/stigs/cci/">disa</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf">hipaa</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat">isa-62443-2009</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu">isa-62443-2013</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.cyber.gov.au/acsc/view-all-content/ism">ism</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.iso.org/contents/data/standard/05/45/54534.html">iso27001-2013</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">nerc-cip</xccdf-1.2:reference>
      <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">nist</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf">nist-csf</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os">os-srg</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.niap-ccevs.org/Profile/PP.cfm">ospp</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">pcidss</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf">pcidss4</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux">stigid</xccdf-1.2:reference>
      <xccdf-1.2:reference href="https://public.cyber.mil/stigs/srg-stig-tools/">stigref</xccdf-1.2:reference>
      <cpe-lang:platform-specification>
        <cpe-lang:platform id="not_ocp4-on-hypershift">
          <cpe-lang:logical-test operator="AND" negate="true">
            <cpe-lang:check-fact-ref system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-eks-cpe-oval.xml" id-ref="oval:ssg-installed_app_is_ocp4_on_hypershift:def:1"/>
          </cpe-lang:logical-test>
        </cpe-lang:platform>
        <cpe-lang:platform id="eks-node">
          <cpe-lang:logical-test operator="AND" negate="false">
            <cpe-lang:check-fact-ref system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="ssg-eks-cpe-oval.xml" id-ref="oval:ssg-installed_app_is_eks_node:def:1"/>
          </cpe-lang:logical-test>
        </cpe-lang:platform>
      </cpe-lang:platform-specification>
      <xccdf-1.2:platform idref="cpe:/a:amazon:elastic_kubernetes_service_node:1.21"/>
      <xccdf-1.2:platform idref="cpe:/o:amazon:elastic_kubernetes_service_node:1"/>
      <xccdf-1.2:platform idref="cpe:/a:amazon:elastic_kubernetes_service:1"/>
      <xccdf-1.2:version update="https://github.com/ComplianceAsCode/content/releases/latest">0.1.73</xccdf-1.2:version>
      <xccdf-1.2:metadata>
        <dc:publisher>SCAP Security Guide Project</dc:publisher>
        <dc:creator>SCAP Security Guide Project</dc:creator>
        <dc:contributor>Frank J Cameron (CAM1244) &lt;cameron@ctc.com&gt;</dc:contributor>
        <dc:contributor>0x66656c6978 &lt;0x66656c6978@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Håvard F. Aasen &lt;havard.f.aasen@pfft.no&gt;</dc:contributor>
        <dc:contributor>Jack Adolph &lt;jack.adolph@gmail.com&gt;</dc:contributor>
        <dc:contributor>Edgar Aguilar &lt;edgar.aguilar@oracle.com&gt;</dc:contributor>
        <dc:contributor>akuster &lt;akuster808@gmail.com&gt;</dc:contributor>
        <dc:contributor>Gabe Alford &lt;redhatrises@gmail.com&gt;</dc:contributor>
        <dc:contributor>Firas AlShafei &lt;firas.alshafei@us.abb.com&gt;</dc:contributor>
        <dc:contributor>Rodrigo Alvares &lt;ralvares@redhat.com&gt;</dc:contributor>
        <dc:contributor>Christopher Anderson &lt;cba@fedoraproject.org&gt;</dc:contributor>
        <dc:contributor>Craig Andrews &lt;candrews@integralblue.com&gt;</dc:contributor>
        <dc:contributor>angystardust &lt;angystardust@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>anivan-suse &lt;anastasija.ivanovic@suse.com&gt;</dc:contributor>
        <dc:contributor>anixon-rh &lt;55244503+anixon-rh@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Stephen L Arnold &lt;sarnold@vctlabs.com&gt;</dc:contributor>
        <dc:contributor>Ikko Ashimine &lt;eltociear@gmail.com&gt;</dc:contributor>
        <dc:contributor>Chuck Atkins &lt;chuck.atkins@kitware.com&gt;</dc:contributor>
        <dc:contributor>Bharath B &lt;bhb@redhat.com&gt;</dc:contributor>
        <dc:contributor>Ryan Ballanger &lt;root@rballang-admin-2.fastenal.com&gt;</dc:contributor>
        <dc:contributor>Alex Baranowski &lt;alex@euro-linux.com&gt;</dc:contributor>
        <dc:contributor>Eduardo Barretto &lt;eduardo.barretto@canonical.com&gt;</dc:contributor>
        <dc:contributor>Paul Bastide &lt;pbastide@redhat.com&gt;</dc:contributor>
        <dc:contributor>Molly Jo Bault &lt;Molly.Jo.Bault@ballardtech.com&gt;</dc:contributor>
        <dc:contributor>Andrew Becker &lt;A-Beck@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Gabriel Becker &lt;ggasparb@redhat.com&gt;</dc:contributor>
        <dc:contributor>BenGui &lt;benoit.guillon1@etu.unilim.fr&gt;</dc:contributor>
        <dc:contributor>Alexander Bergmann &lt;abergmann@suse.com&gt;</dc:contributor>
        <dc:contributor>Dale Bewley &lt;dale@bewley.net&gt;</dc:contributor>
        <dc:contributor>Jose Luis BG &lt;bgjoseluis@gmail.com&gt;</dc:contributor>
        <dc:contributor>binyanling &lt;binyanling@uniontech.com&gt;</dc:contributor>
        <dc:contributor>Joseph Bisch &lt;joseph.bisch@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jeff Blank &lt;blank@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Olivier Bonhomme &lt;ptitoliv@ptitoliv.net&gt;</dc:contributor>
        <dc:contributor>Lance Bragstad &lt;lbragstad@gmail.com&gt;</dc:contributor>
        <dc:contributor>Ted Brunell &lt;tbrunell@redhat.com&gt;</dc:contributor>
        <dc:contributor>Marcus Burghardt &lt;maburgha@redhat.com&gt;</dc:contributor>
        <dc:contributor>Matthew Burket &lt;mburket@redhat.com&gt;</dc:contributor>
        <dc:contributor>Blake Burkhart &lt;blake.burkhart@us.af.mil&gt;</dc:contributor>
        <dc:contributor>Patrick Callahan &lt;pmc@patrickcallahan.com&gt;</dc:contributor>
        <dc:contributor>George Campbell &lt;gcampbell@palantir.com&gt;</dc:contributor>
        <dc:contributor>Nick Carboni &lt;ncarboni@redhat.com&gt;</dc:contributor>
        <dc:contributor>Carlos &lt;64919342+carlosmmatos@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>James Cassell &lt;james.cassell@ll.mit.edu&gt;</dc:contributor>
        <dc:contributor>Frank Caviggia &lt;fcaviggia@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Eric Christensen &lt;echriste@redhat.com&gt;</dc:contributor>
        <dc:contributor>Dan Clark &lt;danclark@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jayson Cofell &lt;1051437+70k10@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>David du Colombier &lt;djc@datadoghq.com&gt;</dc:contributor>
        <dc:contributor>Commandcracker &lt;lukas.fricke.dev@gmail.com&gt;</dc:contributor>
        <dc:contributor>Caleb Cooper &lt;coopercd@ornl.gov&gt;</dc:contributor>
        <dc:contributor>CoreyCook8 &lt;129206271+CoreyCook8@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>cortesana &lt;acortes@redhat.com&gt;</dc:contributor>
        <dc:contributor>Richard Maciel Costa &lt;richard.maciel.costa@canonical.com&gt;</dc:contributor>
        <dc:contributor>Xavier Coulon &lt;xavier.coulon@suse.com&gt;</dc:contributor>
        <dc:contributor>Deric Crago &lt;deric.crago@gmail.com&gt;</dc:contributor>
        <dc:contributor>crleekwc &lt;crleekwc@gmail.com&gt;</dc:contributor>
        <dc:contributor>cueball23 &lt;christoph.alms@westnetz.de&gt;</dc:contributor>
        <dc:contributor>cyarbrough76 &lt;42849651+cyarbrough76@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Maura Dailey &lt;maura@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Klaas Demter &lt;demter@atix.de&gt;</dc:contributor>
        <dc:contributor>denknorr &lt;dennis.knorr@suse.com&gt;</dc:contributor>
        <dc:contributor>dependabot[bot] &lt;49699333+dependabot[bot]@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>dhanushkar-wso2 &lt;dhanushkar@wso2.com&gt;</dc:contributor>
        <dc:contributor>Andrew DiPrinzio &lt;andrew.diprinzio@jhuapl.edu&gt;</dc:contributor>
        <dc:contributor>dom &lt;dominique.blaze@devinci.fr&gt;</dc:contributor>
        <dc:contributor>Jean-Baptiste Donnette &lt;jean-baptiste.donnette@epita.fr&gt;</dc:contributor>
        <dc:contributor>Marco De Donno &lt;mdedonno1337@gmail.com&gt;</dc:contributor>
        <dc:contributor>dperrone &lt;dperrone@redhat.com&gt;</dc:contributor>
        <dc:contributor>drax &lt;applezip@gmail.com&gt;</dc:contributor>
        <dc:contributor>Sebastian Dunne &lt;sdunne@redhat.com&gt;</dc:contributor>
        <dc:contributor>François Duthilleul &lt;francoisduthilleul@gmail.com&gt;</dc:contributor>
        <dc:contributor>Greg Elin &lt;gregelin@gitmachines.com&gt;</dc:contributor>
        <dc:contributor>eradot4027 &lt;jrtonmac@gmail.com&gt;</dc:contributor>
        <dc:contributor>ermeratos &lt;manuel.ermer@atos.net&gt;</dc:contributor>
        <dc:contributor>Alexis Facques &lt;alexis.facques@mythalesgroup.io&gt;</dc:contributor>
        <dc:contributor>Henry Finucane &lt;hfinucane@zscaler.com&gt;</dc:contributor>
        <dc:contributor>Leah Fisher &lt;lfisher047@gmail.com&gt;</dc:contributor>
        <dc:contributor>Yavor Georgiev &lt;strandjata@gmail.com&gt;</dc:contributor>
        <dc:contributor>Alijohn Ghassemlouei &lt;alijohn@secureagc.com&gt;</dc:contributor>
        <dc:contributor>Swarup Ghosh &lt;swghosh@redhat.com&gt;</dc:contributor>
        <dc:contributor>ghylock &lt;ghylock@gmail.com&gt;</dc:contributor>
        <dc:contributor>Andrew Gilmore &lt;agilmore2@gmail.com&gt;</dc:contributor>
        <dc:contributor>Joshua Glemza &lt;jglemza@nasa.gov&gt;</dc:contributor>
        <dc:contributor>Nick Gompper &lt;forestgomp@yahoo.com&gt;</dc:contributor>
        <dc:contributor>David Fernandez Gonzalez &lt;david.fernandezgonzalez@canonical.com&gt;</dc:contributor>
        <dc:contributor>Loren Gordon &lt;lorengordon@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Gene Gotimer &lt;otherdevopsgene@portinfo.com&gt;</dc:contributor>
        <dc:contributor>Patrik Greco &lt;sikevux@sikevux.se&gt;</dc:contributor>
        <dc:contributor>Steve Grubb &lt;sgrubb@redhat.com&gt;</dc:contributor>
        <dc:contributor>guangyee &lt;gyee@suse.com&gt;</dc:contributor>
        <dc:contributor>Christian Hagenest &lt;christian.hagenest@suse.com&gt;</dc:contributor>
        <dc:contributor>Marek Haicman &lt;mhaicman@redhat.com&gt;</dc:contributor>
        <dc:contributor>Vern Hart &lt;vern.hart@canonical.com&gt;</dc:contributor>
        <dc:contributor>Alex Haydock &lt;alex@alexhaydock.co.uk&gt;</dc:contributor>
        <dc:contributor>Rebekah Hayes &lt;rhayes@corp.rivierautilities.com&gt;</dc:contributor>
        <dc:contributor>Trey Henefield &lt;thenefield@gmail.com&gt;</dc:contributor>
        <dc:contributor>Henning Henkel &lt;henning.henkel@helvetia.ch&gt;</dc:contributor>
        <dc:contributor>hex2a &lt;hex2a@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>John Hooks &lt;jhooks@starscream.pa.jhbcomputers.com&gt;</dc:contributor>
        <dc:contributor>Jakub Hrozek &lt;jhrozek@redhat.com&gt;</dc:contributor>
        <dc:contributor>De Huo &lt;De.Huo@windriver.com&gt;</dc:contributor>
        <dc:contributor>Robin Price II &lt;robin@redhat.com&gt;</dc:contributor>
        <dc:contributor>Yasir Imam &lt;yimam@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jiri Jaburek &lt;jjaburek@redhat.com&gt;</dc:contributor>
        <dc:contributor>Keith Jackson &lt;keithkjackson@gmail.com&gt;</dc:contributor>
        <dc:contributor>Marc Jadoul &lt;mgjadoul@laptomatic.auth-o-matic.corp&gt;</dc:contributor>
        <dc:contributor>Jeremiah Jahn &lt;jeremiah@goodinassociates.com&gt;</dc:contributor>
        <dc:contributor>Jakub Jelen &lt;jjelen@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jessicahfy &lt;Jessicahfy@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Stephan Joerrens &lt;Stephan.Joerrens@fiduciagad.de&gt;</dc:contributor>
        <dc:contributor>Hunter Jones &lt;hjones2199@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jono &lt;jono@ubuntu-18.localdomain&gt;</dc:contributor>
        <dc:contributor>justchris1 &lt;justchris1@justchris1.email&gt;</dc:contributor>
        <dc:contributor>Kacper &lt;kacper@kacper.se&gt;</dc:contributor>
        <dc:contributor>Kai Kang &lt;kai.kang@windriver.com&gt;</dc:contributor>
        <dc:contributor>Charles Kernstock &lt;charles.kernstock@ultra-ats.com&gt;</dc:contributor>
        <dc:contributor>Yuli Khodorkovskiy &lt;ykhodorkovskiy@tresys.com&gt;</dc:contributor>
        <dc:contributor>Sherine Khoury &lt;skhoury@redhat.com&gt;</dc:contributor>
        <dc:contributor>Nathan Kinder &lt;nkinder@redhat.com&gt;</dc:contributor>
        <dc:contributor>Lee Kinser &lt;lee.kinser@gmail.com&gt;</dc:contributor>
        <dc:contributor>Evgeny Kolesnikov &lt;ekolesni@redhat.com&gt;</dc:contributor>
        <dc:contributor>Peter 'Pessoft' Kolínek &lt;github@pessoft.com&gt;</dc:contributor>
        <dc:contributor>Luke Kordell &lt;luke.t.kordell@lmco.com&gt;</dc:contributor>
        <dc:contributor>Malte Kraus &lt;malte.kraus@suse.com&gt;</dc:contributor>
        <dc:contributor>Seth Kress &lt;seth.kress@dsainc.com&gt;</dc:contributor>
        <dc:contributor>Felix Krohn &lt;felix.krohn@helvetia.ch&gt;</dc:contributor>
        <dc:contributor>kspargur &lt;kspargur@kspargur.csb&gt;</dc:contributor>
        <dc:contributor>Amit Kumar &lt;amitkuma@redhat.com&gt;</dc:contributor>
        <dc:contributor>Fen Labalme &lt;fen@civicactions.com&gt;</dc:contributor>
        <dc:contributor>Dexter Le &lt;dexter.le@sap.com&gt;</dc:contributor>
        <dc:contributor>Ade Lee &lt;alee@redhat.com&gt;</dc:contributor>
        <dc:contributor>Christopher Lee &lt;Crleekwc@gmail.com&gt;</dc:contributor>
        <dc:contributor>Ian Lee &lt;lee1001@llnl.gov&gt;</dc:contributor>
        <dc:contributor>Jarrett Lee &lt;jarrettl@umd.edu&gt;</dc:contributor>
        <dc:contributor>Joseph Lenox &lt;joseph.lenox@collins.com&gt;</dc:contributor>
        <dc:contributor>Jan Lieskovsky &lt;jlieskov@redhat.com&gt;</dc:contributor>
        <dc:contributor>Markus Linnala &lt;Markus.Linnala@knowit.fi&gt;</dc:contributor>
        <dc:contributor>Flos Lonicerae &lt;lonicerae@gmail.com&gt;</dc:contributor>
        <dc:contributor>Simon Lukasik &lt;slukasik@redhat.com&gt;</dc:contributor>
        <dc:contributor>Milan Lysonek &lt;mlysonek@redhat.com&gt;</dc:contributor>
        <dc:contributor>Fredrik Lysén &lt;fredrik@pipemore.se&gt;</dc:contributor>
        <dc:contributor>Mackemania &lt;8738793+Mackemania@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Caitlin Macleod &lt;caitelatte@gmail.com&gt;</dc:contributor>
        <dc:contributor>Nick Maludy &lt;nmaludy@gmail.com&gt;</dc:contributor>
        <dc:contributor>Lokesh Mandvekar &lt;lsm5@fedoraproject.org&gt;</dc:contributor>
        <dc:contributor>Matus Marhefka &lt;mmarhefk@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jamie Lorwey Martin &lt;jlmartin@redhat.com&gt;</dc:contributor>
        <dc:contributor>Carlos Matos &lt;cmatos@redhat.com&gt;</dc:contributor>
        <dc:contributor>Robert McAllister &lt;rmcallis@redhat.com&gt;</dc:contributor>
        <dc:contributor>Karen McCarron &lt;kmccarro@redhat.com&gt;</dc:contributor>
        <dc:contributor>Michael McConachie &lt;michael@redhat.com&gt;</dc:contributor>
        <dc:contributor>Marcus Meissner &lt;meissner@suse.de&gt;</dc:contributor>
        <dc:contributor>Khary Mendez &lt;kmendez@redhat.com&gt;</dc:contributor>
        <dc:contributor>Rodney Mercer &lt;rmercer@harris.com&gt;</dc:contributor>
        <dc:contributor>Matt Micene &lt;nzwulfin@gmail.com&gt;</dc:contributor>
        <dc:contributor>Brian Millett &lt;bmillett@gmail.com&gt;</dc:contributor>
        <dc:contributor>Takuya Mishina &lt;tmishina@jp.ibm.com&gt;</dc:contributor>
        <dc:contributor>Mixer9 &lt;35545791+Mixer9@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>mmosel &lt;mmosel@kde.example.com&gt;</dc:contributor>
        <dc:contributor>Thomas Montague &lt;montague.thomas@gmail.com&gt;</dc:contributor>
        <dc:contributor>Zbynek Moravec &lt;zmoravec@redhat.com&gt;</dc:contributor>
        <dc:contributor>Kazuo Moriwaka &lt;moriwaka@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Michael Moseley &lt;michael@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Ross Murphy &lt;RossMurphy@ibm.com&gt;</dc:contributor>
        <dc:contributor>Renaud Métrich &lt;rmetrich@redhat.com&gt;</dc:contributor>
        <dc:contributor>Joe Nall &lt;joe@nall.com&gt;</dc:contributor>
        <dc:contributor>Neiloy &lt;neiloy@redhat.com&gt;</dc:contributor>
        <dc:contributor>Axel Nennker &lt;axel@nennker.de&gt;</dc:contributor>
        <dc:contributor>Michele Newman &lt;mnewman@redhat.com&gt;</dc:contributor>
        <dc:contributor>nnerdmann &lt;128606223+nnerdmann@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Sean O'Keeffe &lt;seanokeeffe797@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jiri Odehnal &lt;jodehnal@redhat.com&gt;</dc:contributor>
        <dc:contributor>Ilya Okomin &lt;ilya.okomin@oracle.com&gt;</dc:contributor>
        <dc:contributor>Kaustubh Padegaonkar &lt;theTuxRacer@gmail.com&gt;</dc:contributor>
        <dc:contributor>Michael Palmiotto &lt;mpalmiotto@tresys.com&gt;</dc:contributor>
        <dc:contributor>Eryx Paredes &lt;eryxp@lyft.com&gt;</dc:contributor>
        <dc:contributor>Max R.D. Parmer &lt;maxp@trystero.is&gt;</dc:contributor>
        <dc:contributor>Arnaud Patard &lt;apatard@hupstream.com&gt;</dc:contributor>
        <dc:contributor>Jan Pazdziora &lt;jpazdziora@redhat.com&gt;</dc:contributor>
        <dc:contributor>pcactr &lt;paul.c.arnold4.ctr@mail.mil&gt;</dc:contributor>
        <dc:contributor>Kenneth Peeples &lt;kennethwpeeples@gmail.com&gt;</dc:contributor>
        <dc:contributor>Nathan Peters &lt;Nathaniel.Peters@ca.com&gt;</dc:contributor>
        <dc:contributor>Frank Lin PIAT &lt;fpiat@klabs.be&gt;</dc:contributor>
        <dc:contributor>Stefan Pietsch &lt;mail.ipv4v6+gh@gmail.com&gt;</dc:contributor>
        <dc:contributor>piggyvenus &lt;piggyvenus@gmail.com&gt;</dc:contributor>
        <dc:contributor>Vojtech Polasek &lt;vpolasek@redhat.com&gt;</dc:contributor>
        <dc:contributor>Orion Poplawski &lt;orion@nwra.com&gt;</dc:contributor>
        <dc:contributor>Jennifer Power &lt;barnabei.jennifer@gmail.com&gt;</dc:contributor>
        <dc:contributor>Nick Poyant &lt;npoyant@redhat.com&gt;</dc:contributor>
        <dc:contributor>Martin Preisler &lt;mpreisle@redhat.com&gt;</dc:contributor>
        <dc:contributor>Wesley Ceraso Prudencio &lt;wcerasop@redhat.com&gt;</dc:contributor>
        <dc:contributor>Raphael Sanchez Prudencio &lt;rsprudencio@redhat.com&gt;</dc:contributor>
        <dc:contributor>Miha Purg &lt;miha.purg@canonical.com&gt;</dc:contributor>
        <dc:contributor>T.O. Radzy Radzykewycz &lt;radzy@windriver.com&gt;</dc:contributor>
        <dc:contributor>rain-Qing &lt;yangyuqing6@qq.com&gt;</dc:contributor>
        <dc:contributor>Kenyon Ralph &lt;kenyon@kenyonralph.com&gt;</dc:contributor>
        <dc:contributor>Mike Ralph &lt;mralph@redhat.com&gt;</dc:contributor>
        <dc:contributor>Federico Ramirez &lt;federico.r.ramirez@oracle.com&gt;</dc:contributor>
        <dc:contributor>rchikov &lt;rumen.chikov@suse.com&gt;</dc:contributor>
        <dc:contributor>Rick Renshaw &lt;Richard_Renshaw@xtoenergy.com&gt;</dc:contributor>
        <dc:contributor>Paul Rensing &lt;prensing@cimetrics.com&gt;</dc:contributor>
        <dc:contributor>Chris Reynolds &lt;c.reynolds82@gmail.com&gt;</dc:contributor>
        <dc:contributor>rhayes &lt;rhayes@rivierautilities.com&gt;</dc:contributor>
        <dc:contributor>Pat Riehecky &lt;riehecky@fnal.gov&gt;</dc:contributor>
        <dc:contributor>rlucente-se-jboss &lt;rlucente@redhat.com&gt;</dc:contributor>
        <dc:contributor>Juan Antonio Osorio Robles &lt;juan.osoriorobles@eu.equinix.com&gt;</dc:contributor>
        <dc:contributor>Paul Roche &lt;paul.roche@menlosecurity.com&gt;</dc:contributor>
        <dc:contributor>Jan Rodak &lt;hony.com@seznam.cz&gt;</dc:contributor>
        <dc:contributor>Matt Rogers &lt;mrogers@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jesse Roland &lt;jesse.roland@onyxpoint.com&gt;</dc:contributor>
        <dc:contributor>Joshua Roys &lt;roysjosh@gmail.com&gt;</dc:contributor>
        <dc:contributor>rrenshaw &lt;bofh69@yahoo.com&gt;</dc:contributor>
        <dc:contributor>Chris Ruffalo &lt;chris.ruffalo@gmail.com&gt;</dc:contributor>
        <dc:contributor>Benjamin Ruland &lt;benjamin.ruland@gmail.com&gt;</dc:contributor>
        <dc:contributor>rumch-se &lt;77793453+rumch-se@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Rutvik &lt;32413084+rutvik23@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>rutvik23 &lt;rutksh@gmail.com&gt;</dc:contributor>
        <dc:contributor>Ray Shaw (Cont ARL/CISD) rvshaw &lt;rvshaw@esme.arl.army.mil&gt;</dc:contributor>
        <dc:contributor>Earl Sampson &lt;ESampson@suse.com&gt;</dc:contributor>
        <dc:contributor>sampsone &lt;esampson@suse.com&gt;</dc:contributor>
        <dc:contributor>Willy Santos &lt;wsantos@redhat.com&gt;</dc:contributor>
        <dc:contributor>Nagarjuna Sarvepalli &lt;snagarju@redhat.com&gt;</dc:contributor>
        <dc:contributor>Anderson Sasaki &lt;33833274+ansasaki@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Gautam Satish &lt;gautams@hpe.com&gt;</dc:contributor>
        <dc:contributor>Watson Sato &lt;wsato@redhat.com&gt;</dc:contributor>
        <dc:contributor>Satoru SATOH &lt;satoru.satoh@gmail.com&gt;</dc:contributor>
        <dc:contributor>Alexander Scheel &lt;alexander.m.scheel@gmail.com&gt;</dc:contributor>
        <dc:contributor>Bryan Schneiders &lt;pschneiders@trisept.com&gt;</dc:contributor>
        <dc:contributor>Robert Schweikert &lt;rjschwei@suse.com&gt;</dc:contributor>
        <dc:contributor>shaneboulden &lt;shane.boulden@gmail.com&gt;</dc:contributor>
        <dc:contributor>Vincent Shen &lt;wenshen@redhat.com&gt;</dc:contributor>
        <dc:contributor>Dhriti Shikhar &lt;dhriti.shikhar.rokz@gmail.com&gt;</dc:contributor>
        <dc:contributor>Spencer Shimko &lt;sshimko@tresys.com&gt;</dc:contributor>
        <dc:contributor>Mark Shoger &lt;mshoger@redhat.com&gt;</dc:contributor>
        <dc:contributor>Shane Siebken &lt;shane.siebken@capellaspace.com&gt;</dc:contributor>
        <dc:contributor>THOBY Simon &lt;Simon.THOBY@viveris.fr&gt;</dc:contributor>
        <dc:contributor>Thomas Sjögren &lt;konstruktoid@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Jindrich Skacel &lt;102800748+jskacel@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Alexandre Skrzyniarz &lt;alexandre.skrzyniarz@laposte.net&gt;</dc:contributor>
        <dc:contributor>Francisco Slavin &lt;fslavin@tresys.com&gt;</dc:contributor>
        <dc:contributor>sluetze &lt;13255307+sluetze@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Dave Smith &lt;dsmith@eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>David Smith &lt;dsmith@fornax.eclipse.ncsc.mil&gt;</dc:contributor>
        <dc:contributor>Kevin Spargur &lt;kspargur@redhat.com&gt;</dc:contributor>
        <dc:contributor>Kenneth Stailey &lt;kstailey.lists@gmail.com&gt;</dc:contributor>
        <dc:contributor>Leland Steinke &lt;leland.j.steinke.ctr@mail.mil&gt;</dc:contributor>
        <dc:contributor>Justin Stephenson &lt;jstephen@redhat.com&gt;</dc:contributor>
        <dc:contributor>steven.y.gui &lt;steven_ygui@163.com&gt;</dc:contributor>
        <dc:contributor>Brian Stinson &lt;brian@bstinson.com&gt;</dc:contributor>
        <dc:contributor>Jake Stookey &lt;jakestookey@gmail.com&gt;</dc:contributor>
        <dc:contributor>Jonathan Sturges &lt;jsturges@redhat.com&gt;</dc:contributor>
        <dc:contributor>svet-se &lt;svetlin.boychev@suse.com&gt;</dc:contributor>
        <dc:contributor>teacup-on-rockingchair &lt;315160+teacup-on-rockingchair@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Ian Tewksbury &lt;itewk@redhat.com&gt;</dc:contributor>
        <dc:contributor>Philippe Thierry &lt;phil@reseau-libre.net&gt;</dc:contributor>
        <dc:contributor>Simon THOBY &lt;git@nightmared.fr&gt;</dc:contributor>
        <dc:contributor>Derek Thurston &lt;thegrit@gmail.com&gt;</dc:contributor>
        <dc:contributor>tianzhenjia &lt;jiatianzhen@cmss.chinamobile.com&gt;</dc:contributor>
        <dc:contributor>Greg Tinsley &lt;gtinsley@redhat.com&gt;</dc:contributor>
        <dc:contributor>Paul Tittle &lt;ptittle@cmf.nrl.navy.mil&gt;</dc:contributor>
        <dc:contributor>tom &lt;tom@localhost.localdomain&gt;</dc:contributor>
        <dc:contributor>tomas.hudik &lt;tomas.hudik@embedit.cz&gt;</dc:contributor>
        <dc:contributor>Jeb Trayer &lt;jeb.d.trayer@uscg.mil&gt;</dc:contributor>
        <dc:contributor>TrilokGeer &lt;tgeer@redhat.com&gt;</dc:contributor>
        <dc:contributor>Viktors Trubovics &lt;viktors.trubovics@suse.com&gt;</dc:contributor>
        <dc:contributor>Nico Truzzolino &lt;nico.truzzolino@gmx.de&gt;</dc:contributor>
        <dc:contributor>Brian Turek &lt;brian.turek@gmail.com&gt;</dc:contributor>
        <dc:contributor>Matěj Týč &lt;matyc@redhat.com&gt;</dc:contributor>
        <dc:contributor>VadimDor &lt;29509093+VadimDor@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Trevor Vaughan &lt;tvaughan@onyxpoint.com&gt;</dc:contributor>
        <dc:contributor>vtrubovics &lt;82443408+vtrubovics@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Samuel Warren &lt;swarren@redhat.com&gt;</dc:contributor>
        <dc:contributor>wcushen &lt;54533890+wcushen@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Shawn Wells &lt;shawn@shawndwells.io&gt;</dc:contributor>
        <dc:contributor>Whidix &lt;31294015+Whidix@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Daniel E. White &lt;linuxdan@users.noreply.github.com&gt;</dc:contributor>
        <dc:contributor>Bernhard M. Wiedemann &lt;bwiedemann@suse.de&gt;</dc:contributor>
        <dc:contributor>Roy Williams &lt;roywilli@roywilli.redhat.com&gt;</dc:contributor>
        <dc:contributor>Willumpie &lt;willumpie@xs4all.nl&gt;</dc:contributor>
        <dc:contributor>Rob Wilmoth &lt;rwilmoth@redhat.com&gt;</dc:contributor>
        <dc:contributor>win97pro &lt;win97pro@protonmail.com&gt;</dc:contributor>
        <dc:contributor>Lucas Yamanishi &lt;lucas.yamanishi@onyxpoint.com&gt;</dc:contributor>
        <dc:contributor>Xirui Yang &lt;xirui.yang@oracle.com&gt;</dc:contributor>
        <dc:contributor>Yuqing Yang &lt;yyq01323329@alibaba-inc.com&gt;</dc:contributor>
        <dc:contributor>yarunachalam &lt;yarunachalam@suse.com&gt;</dc:contributor>
        <dc:contributor>Guang Yee &lt;guang.yee@suse.com&gt;</dc:contributor>
        <dc:contributor>Achilleas John Yfantis &lt;ayfantis@redhat.com&gt;</dc:contributor>
        <dc:contributor>YiLin.Li &lt;YiLin.Li@linux.alibaba.com&gt;</dc:contributor>
        <dc:contributor>YuQing &lt;yyq0391@163.com&gt;</dc:contributor>
        <dc:contributor>Kevin Zimmerman &lt;kevin.zimmerman@kitware.com&gt;</dc:contributor>
        <dc:contributor>Luigi Mario Zuccarelli &lt;luzuccar@redhat.com&gt;</dc:contributor>
        <dc:contributor>Jan Černý &lt;jcerny@redhat.com&gt;</dc:contributor>
        <dc:contributor>Michal Šrubař &lt;msrubar@redhat.com&gt;</dc:contributor>
        <dc:source>https://github.com/ComplianceAsCode/content/releases/latest</dc:source>
      </xccdf-1.2:metadata>
      <xccdf-1.2:Profile id="xccdf_org.ssgproject.content_profile_cis-node">
        <xccdf-1.2:title override="true">CIS Amazon Elastic Kubernetes Service (EKS) Benchmark - Node</xccdf-1.2:title>
        <xccdf-1.2:description override="true">This profile defines a baseline that aligns to the Center for Internet Security®
Amazon Elastic Kubernetes Service (EKS) Benchmark™, V1.0.1.

This profile includes Center for Internet Security®
Amazon Elastic Kubernetes Service (EKS)™ content.

This profile is applicable to EKS 1.21 and greater.</xccdf-1.2:description>
        <xccdf-1.2:platform idref="cpe:/o:amazon:elastic_kubernetes_service_node:1"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_file_groupowner_kubelet_conf" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_file_groupowner_worker_kubeconfig" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_file_owner_kubelet_conf" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_file_owner_worker_kubeconfig" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_file_permissions_kubelet_conf" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_file_permissions_worker_kubeconfig" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_anonymous_auth" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_authorization_mode" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_disable_hostname_override" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_enable_cert_rotation" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_enable_client_cert_rotation" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_enable_iptables_util_chains" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_defaults" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_enable_server_cert_rotation" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_enable_streaming_connections" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_accounts" selected="false"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_authentication" selected="false"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_general" selected="false"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_logging" selected="false"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_networking" selected="false"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_registry" selected="false"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_secrets" selected="false"/>
      </xccdf-1.2:Profile>
      <xccdf-1.2:Profile id="xccdf_org.ssgproject.content_profile_cis">
        <xccdf-1.2:title override="true">CIS Amazon Elastic Kubernetes Service Benchmark - Platform</xccdf-1.2:title>
        <xccdf-1.2:description override="true">This profile defines a baseline that aligns to the Center for Internet Security®
Amazon Elastic Kubernetes Service (EKS) Benchmark™, V1.0.1.

This profile includes Center for Internet Security®
Amazon Elastic Kubernetes Service (EKS)™ content.

This profile is applicable to EKS 1.21 and greater.</xccdf-1.2:description>
        <xccdf-1.2:platform idref="cpe:/a:amazon:elastic_kubernetes_service:1"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_approved_registries" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_audit_logging" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_configure_network_policy" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_configure_tls" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_control_plane_access" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_dedicated_service_accounts" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_endpoint_configuration" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_fargate" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_iam_integration" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_image_scanning" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_configure_client_ca" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_kubelet_read_only_port_secured" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_private_nodes" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_read_only_registry_access" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_registry_access" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_rule_secret_encryption" selected="true"/>
        <xccdf-1.2:select idref="xccdf_org.ssgproject.content_group_worker" selected="false"/>
      </xccdf-1.2:Profile>
      <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_openshift">
        <xccdf-1.2:title>Kubernetes Settings</xccdf-1.2:title>
        <xccdf-1.2:description>Each section of this configuration guide includes information about the
configuration of a Kubernetes cluster and a set of recommendations for
hardening the configuration. For each hardening recommendation, information
on how to implement the control and/or how to verify or audit the control
is provided. In some cases, remediation information is also provided.

Some of the settings in the hardening guide are in place by default. The
audit information for these settings is provided in order to verify that
the cluster administrator has not made changes that would be less secure.
A small number of items require configuration.

Finally, there are some recommendations that require decisions by the
system operator, such as audit log size, retention, and related settings.</xccdf-1.2:description>
        <xccdf-1.2:Value id="xccdf_org.ssgproject.content_value_ocp_data_root" type="string">
          <xccdf-1.2:title>Root of files obtained from OCP nodes</xccdf-1.2:title>
          <xccdf-1.2:description>When scanning OpenShift clusters, some settings are not exposed as files.
In the case that they are exported from the cluster (typically as yaml files),
this variable determines the directory where they will end up.</xccdf-1.2:description>
          <xccdf-1.2:value>/kubernetes-api-resources</xccdf-1.2:value>
        </xccdf-1.2:Value>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_accounts">
          <xccdf-1.2:title>Kubernetes - Account and Access Control</xccdf-1.2:title>
          <xccdf-1.2:description>In traditional Unix security, if an attacker gains
shell access to a certain login account, they can perform any action
or access any file to which that account has access. The same
idea applies to cloud technology such as Kubernetes. Therefore,
making it more difficult for unauthorized people to gain shell
access to accounts, particularly to privileged accounts, is a
necessary part of securing a system. This section introduces
mechanisms for restricting access to accounts under
Kubernetes.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_dedicated_service_accounts" severity="unknown">
            <xccdf-1.2:title>Use Dedicated Service Accounts</xccdf-1.2:title>
            <xccdf-1.2:description>Kubernetes workloads should not use cluster node service accounts to
authenticate to Amazon EKS APIs. Each Kubernetes workload that needs to
authenticate to other AWS services using AWS IAM should be provisioned with a
dedicated Service account.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.2.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Manual approaches for authenticating Kubernetes workloads running on Amazon
EKS against AWS APIs are: storing service account keys as a Kubernetes secret
(which introduces manual key rotation and potential for key compromise); or
use of the underlying nodes' IAM Service account, which violates the
principle of least privilege on a multi-tenanted node, when one pod needs
to have access to a service, but every other pod on the node that uses the
Service account does not.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-87818-1</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-dedicated_service_accounts_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_authentication">
          <xccdf-1.2:title>Authentication</xccdf-1.2:title>
          <xccdf-1.2:description>In cloud workloads, there are many ways to create and configure
to multiple authentication services. Some of these authentication
methods by not be secure or common methodologies, or they may not
be secure by default. This section introduces mechanisms for
configuring authentication systems Kubernetes.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_iam_integration" severity="unknown">
            <xccdf-1.2:title>Manage Users with AWS IAM</xccdf-1.2:title>
            <xccdf-1.2:description>Amazon EKS uses IAM to provide authentication to your Kubernetes cluster
through the AWS IAM Authenticator for Kubernetes. You can configure the stock
kubectl client to work with Amazon EKS by installing the AWS IAM
Authenticator for Kubernetes and modifying your kubectl configuration file to
use it for authentication.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.5.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>On- and off-boarding users is often difficult to automate and prone to error.
Using a single source of truth for user permissions reduces the number of
locations that an individual must be off-boarded from, and prevents users
gaining unique permissions sets that increase the cost of audit.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-86301-9</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-iam_integration_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_general">
          <xccdf-1.2:title>Kubernetes - General Security Practices</xccdf-1.2:title>
          <xccdf-1.2:description>Contains evaluations for general security practices for operating a Kubernetes environment.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_fargate" severity="unknown">
            <xccdf-1.2:title>Consider Fargate for Untrusted Workloads</xccdf-1.2:title>
            <xccdf-1.2:description>It is Best Practice to restrict or fence untrusted workloads when running in
a multi-tenant environment.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.6.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>AWS Fargate is a technology that provides on-demand, right-sized compute
capacity for containers. With AWS Fargate, you no longer have to provision,
configure, or scale groups of virtual machines to run containers. This
removes the need to choose server types, decide when to scale your node
groups, or optimize cluster packing.

You can control which pods start on Fargate and how they run with Fargate
profiles, which are defined as part of your Amazon EKS cluster.

Amazon EKS integrates Kubernetes with AWS Fargate by using controllers that
are built by AWS using the upstream, extensible model provided by Kubernetes.
These controllers run as part of the Amazon EKS managed Kubernetes control
plane and are responsible for scheduling native Kubernetes pods onto Fargate.
The Fargate controllers include a new scheduler that runs alongside the
default Kubernetes scheduler in addition to several mutating and validating
admission controllers. When you start a pod that meets the criteria for
running on Fargate, the Fargate controllers running in the cluster recognize,
update, and schedule the pod onto Fargate.

Each pod running on Fargate has its own isolation boundary and does not share
the underlying kernel, CPU resources, memory resources, or elastic network
interface with another pod.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-89091-3</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-fargate_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_kubelet">
          <xccdf-1.2:title>Kubernetes Kubelet Settings</xccdf-1.2:title>
          <xccdf-1.2:description>The Kubernetes Kubelet is an agent that runs on each node in the cluster. It
makes sure that containers are running in a pod.

The kubelet takes a set of PodSpecs that are provided through various
mechanisms and ensures that the containers described in those PodSpecs are
running and healthy. The kubelet doesn’t manage containers which were not
created by Kubernetes.</xccdf-1.2:description>
          <xccdf-1.2:Value id="xccdf_org.ssgproject.content_value_var_streaming_connection_timeouts" type="string" interactive="true">
            <xccdf-1.2:title>Streaming Connection Timeout Options</xccdf-1.2:title>
            <xccdf-1.2:description>Time until connection timeouts. Use (s) for seconds, (m) for minutes,
and (h) for hours.</xccdf-1.2:description>
            <xccdf-1.2:value>4h0m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="5min">5m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="10min">10m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="30min">30m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="1hour">1h0m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="2hours">2h0m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="4hours">4h0m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="6hours">6h0m0s</xccdf-1.2:value>
            <xccdf-1.2:value selector="8hours">8h0m0s</xccdf-1.2:value>
          </xccdf-1.2:Value>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_anonymous_auth" severity="medium">
            <xccdf-1.2:title>Disable Anonymous Authentication to the Kubelet</xccdf-1.2:title>
            <xccdf-1.2:description>By default, anonymous access to the Kubelet server is enabled. This
configuration check ensures that anonymous requests to the Kubelet
server are disabled. Edit the Kubelet server configuration file
<html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code> on the kubelet node(s)
and set the below parameter:
<html:pre>
authentication:
  ...
  anonymous:
    enabled: false
  ...
</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/International/bsi_it_gs_comp_2022.pdf">APP.4.4.A3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>When enabled, requests that are not rejected by other configured
authentication methods are treated as anonymous requests. These
requests are then served by the Kubelet server. OpenShift Operators should
rely on authentication to authorize access and disallow anonymous
requests.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_anonymous_auth:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_anonymous_auth_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_authorization_mode" severity="medium">
            <xccdf-1.2:title>Ensure authorization is set to Webhook</xccdf-1.2:title>
            <xccdf-1.2:description>Unauthenticated/unauthorized users should have no access to OpenShift nodes.
The Kubelet should be set to only allow Webhook authorization.
To ensure that the Kubelet requires authorization,
validate that <html:code>authorization</html:code> is configured to <html:code>Webhook</html:code>
in <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>:
<html:pre>
authorization:
  mode: Webhook
  ...
</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.2</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Ensuring that the authorization is configured correctly helps enforce that
unauthenticated/unauthorized users have no access to OpenShift nodes.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_authorization_mode:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_authorization_mode_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_configure_client_ca" severity="medium">
            <xccdf-1.2:title>kubelet - Configure the Client CA Certificate</xccdf-1.2:title>
            <xccdf-1.2:description>By default, the kubelet is not configured with a CA certificate which
can subject the kubelet to man-in-the-middle attacks.

To configure a client CA certificate, edit the kubelet configuration
file <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>
on the kubelet node(s) and set the below parameter:
<html:pre>
authentication:
...
  x509:
    clientCAFile: /etc/kubernetes/pki/ca.crt
...
</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.3</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Not having a CA certificate for the kubelet will subject the kubelet to possible
man-in-the-middle attacks especially on unsafe or untrusted networks.
Certificate validation for the kubelet allows the API server to validate
the kubelet's identity.</xccdf-1.2:rationale>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_configure_client_ca:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_configure_client_ca_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_disable_hostname_override" severity="low">
            <xccdf-1.2:title>kubelet - Hostname Override handling</xccdf-1.2:title>
            <xccdf-1.2:description>Normally, OpenShift lets the kubelet get the hostname from either the
cloud provider itself, or from the node's hostname. This ensures that
the PKI allocated by the deployment uses the appropriate values, is valid
and keeps working throughout the lifecycle of the cluster. IP addresses
are not used, and hence this makes it easier for security analysts to
associate kubelet logs with the appropriate node.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-3 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-3 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.8</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Allowing hostnames to be overridden creates issues around resolving nodes
in addition to TLS configuration, certificate validation, and log correlation
and validation.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_disable_hostname_override:def:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_cert_rotation" severity="medium">
            <xccdf-1.2:title>kubelet - Enable Certificate Rotation</xccdf-1.2:title>
            <xccdf-1.2:description>To enable the kubelet to rotate client certificates, edit the kubelet configuration
file <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>
on the kubelet node(s) and set the below parameter:
<html:pre>
...
rotateCertificates: true
...
</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.10</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Allowing the kubelet to auto-update the certificates ensure that there is no downtime
in certificate renewal as well as ensures confidentiality and integrity.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_cert_rotation:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_cert_rotation_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_client_cert_rotation" severity="medium">
            <xccdf-1.2:title>kubelet - Enable Client Certificate Rotation</xccdf-1.2:title>
            <xccdf-1.2:description>To enable the kubelet to rotate client certificates, edit the kubelet configuration
file <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>
on the kubelet node(s) and set the below parameter:
<html:pre>
featureGates:
...
  RotateKubeletClientCertificate: true
...
</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.10</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Allowing the kubelet to auto-update the certificates ensure that there is no downtime
in certificate renewal as well as ensures confidentiality and integrity.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_client_cert_rotation:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_client_cert_rotation_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_iptables_util_chains" severity="medium">
            <xccdf-1.2:title>kubelet - Allow Automatic Firewall Configuration</xccdf-1.2:title>
            <xccdf-1.2:description>The kubelet has the ability to automatically configure the firewall to allow
the containers required ports and connections to networking resources and destinations
parameters potentially creating a security incident.
To allow the kubelet to modify the firewall, edit the kubelet configuration
file <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>
on the kubelet node(s) and set the below parameter:
<html:pre>makeIPTablesUtilChains: true</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.7</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The kubelet should automatically configure the firewall settings to allow access and
networking traffic through. This ensures that when a pod or container is running that
the correct ports are configured as well as removing the ports when a pod or
container is no longer in existence.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_iptables_util_chains:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_iptables_util_chains_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_defaults" severity="medium">
            <xccdf-1.2:title>kubelet - Enable Protect Kernel Defaults</xccdf-1.2:title>
            <xccdf-1.2:description>
              <html:p>
Protect tuned kernel parameters from being overwritten by the kubelet.
</html:p>
            </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Kernel parameters are usually tuned and hardened by the system administrators
before putting the systems into production. These parameters protect the
kernel and the system. Your kubelet kernel defaults that rely on such
parameters should be appropriately set to match the desired secured system
state. Ignoring this could potentially lead to running pods with undesired
kernel behavior.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_protect_kernel_defaults:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_protect_kernel_defaults_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_server_cert_rotation" severity="medium">
            <xccdf-1.2:title>kubelet - Enable Server Certificate Rotation</xccdf-1.2:title>
            <xccdf-1.2:description>To enable the kubelet to rotate server certificates, edit the kubelet configuration
file <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>
on the kubelet node(s) and set the below parameter:
<html:pre>
serverTLSBootstrap: true
</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.11</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Allowing the kubelet to auto-update the certificates ensure that there is no downtime
in certificate renewal as well as ensures confidentiality and integrity.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_server_cert_rotation:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_server_cert_rotation_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_streaming_connections" severity="medium">
            <xccdf-1.2:title>kubelet - Do Not Disable Streaming Timeouts</xccdf-1.2:title>
            <xccdf-1.2:description>Timouts for streaming connections should not be disabled as they help to prevent
denial-of-service attacks.
To configure streaming connection timeouts
To set the <html:code>streamingConnectionIdleTimeout</html:code> option for the kubelet,
create a <html:code>KubeletConfig</html:code> option along these lines:
<html:pre>
apiVersion: machineconfiguration.openshift.io/v1
kind: KubeletConfig
metadata:
   name: kubelet-config-$pool
spec:
    machineConfigPoolSelector:
        matchLabels:
            pools.operator.machineconfiguration.openshift.io/$pool_name: ""
    kubeletConfig:
        streamingConnectionIdleTimeout: <xccdf-1.2:sub idref="xccdf_org.ssgproject.content_value_var_streaming_connection_timeouts" use="legacy"/>
       </html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.5</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Ensuring connections have timeouts helps to protect against denial-of-service attacks as
well as disconnect inactive connections. In addition, setting connections timeouts helps
to prevent from running out of ephemeral ports.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_streaming_connections:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_streaming_connections_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_enable_streaming_connections_deprecated" severity="medium">
            <xccdf-1.2:title>kubelet - Do Not Disable Streaming Timeouts</xccdf-1.2:title>
            <xccdf-1.2:description>Timeouts for streaming connections should not be disabled as they help to prevent
denial-of-service attacks.
To configure streaming connection timeouts, edit the kubelet configuration
file <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>
on the kubelet node(s) and set the below parameter:
<html:pre>streamingConnectionIdleTimeout: <xccdf-1.2:sub idref="xccdf_org.ssgproject.content_value_var_streaming_connection_timeouts" use="legacy"/>
       </html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.5</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Ensuring connections have timeouts helps to protect against denial-of-service attacks as
well as disconnect inactive connections. In addition, setting connections timeouts helps
to prevent from running out of ephemeral ports.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-export export-name="oval:ssg-var_streaming_connection_timeouts:var:1" value-id="xccdf_org.ssgproject.content_value_var_streaming_connection_timeouts"/>
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_enable_streaming_connections_deprecated:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_enable_streaming_connections_deprecated_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_kubelet_read_only_port_secured" severity="medium">
            <xccdf-1.2:title>kubelet - Ensure that the --read-only-port is secured</xccdf-1.2:title>
            <xccdf-1.2:description>Disable the read-only port.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.2.4</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The Kubelet process provides a read-only API in addition to the main Kubelet API.
Unauthenticated access is provided to this read-only API which could possibly retrieve
potentially sensitive information about the cluster.</xccdf-1.2:rationale>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-kubelet_read_only_port_secured:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-kubelet_read_only_port_secured_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_logging">
          <xccdf-1.2:title>OpenShift - Logging Settings</xccdf-1.2:title>
          <xccdf-1.2:description>Contains evaluations for the cluster's logging configuration settings.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_audit_logging" severity="unknown">
            <xccdf-1.2:title>Ensure Audit Logging is Enabled</xccdf-1.2:title>
            <xccdf-1.2:description>The audit logs are part of the EKS managed Kubernetes control plane logs that
are managed by Amazon EKS. Amazon EKS is integrated with AWS CloudTrail, a
service that provides a record of actions taken by a user, role, or an AWS
service in Amazon EKS. CloudTrail captures all API calls for Amazon EKS as
events. The calls captured include calls from the Amazon EKS console and code
calls to the Amazon EKS API operations.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">2.1.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Exporting logs and metrics to a dedicated, persistent datastore such as
CloudTrail ensures availability of audit data following a cluster security
event, and provides a central location for analysis of log and metric data
collated from multiple sources.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-87445-3</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-audit_logging_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_networking">
          <xccdf-1.2:title>Kubernetes - Network Configuration and Firewalls</xccdf-1.2:title>
          <xccdf-1.2:description>Most systems must be connected to a network of some
sort, and this brings with it the substantial risk of network
attack. This section discusses the security impact of decisions
about networking which must be made when configuring a system.
<html:br/>
      <html:br/>
This section also discusses firewalls, network access
controls, and other network security frameworks, which allow
system-level rules to be written that can limit an attackers' ability
to connect to your system. These rules can specify that network
traffic should be allowed or denied from certain IP addresses,
hosts, and networks. The rules can also specify which of the
system's network services are available to particular hosts or
networks.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_configure_network_policies_namespaces" severity="high">
            <xccdf-1.2:title>Ensure that application Namespaces have Network Policies defined.</xccdf-1.2:title>
            <xccdf-1.2:description>Use network policies to isolate traffic in your cluster network.</xccdf-1.2:description>
            <xccdf-1.2:warning category="general">This rule's check operates on the cluster configuration dump.
Therefore, you need to use a tool that can query the OCP API, retrieve the following:
<html:ul><html:li><html:code class="ocp-api-endpoint" id="51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300">/apis/networking.k8s.io/v1/networkpolicies</html:code>
    API endpoint, filter with with the <html:code>jq</html:code> utility using the following filter
    <html:code class="ocp-api-filter" id="filter-51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300">[.items[] | select((.metadata.namespace | startswith("openshift") | not) and (.metadata.namespace | startswith("kube-") | not) and .metadata.namespace != "default") | .metadata.namespace] | unique</html:code>
    and persist it to the local
    <html:code class="ocp-dump-location" id="dump-51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300"><xccdf-1.2:sub idref="xccdf_org.ssgproject.content_value_ocp_data_root" use="legacy"/>/apis/networking.k8s.io/v1/networkpolicies#51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300</html:code>
    file.
  </html:li><html:li><html:code class="ocp-api-endpoint" id="34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d">/api/v1/namespaces</html:code>
    API endpoint, filter with with the <html:code>jq</html:code> utility using the following filter
    <html:code class="ocp-api-filter" id="filter-34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d">[.items[] | select((.metadata.name | startswith("openshift") | not) and (.metadata.name | startswith("kube-") | not) and .metadata.name != "default")]</html:code>
    and persist it to the local
    <html:code class="ocp-dump-location" id="dump-34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d"><xccdf-1.2:sub idref="xccdf_org.ssgproject.content_value_ocp_data_root" use="legacy"/>/api/v1/namespaces#34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d</html:code>
    file.
  </html:li></html:ul>
      </xccdf-1.2:warning>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R4</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R4.2</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R5</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R2.2.4</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.2</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R2.3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R5.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-4</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">AC-4(21)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CA-3(5)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-7(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(3)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(5)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(8)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(12)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(13)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(18)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SC-7(10)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">SI-4(22)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-1.1.4</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-1.2</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-1.2.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-1.3.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-1.3.2</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf">Req-2.2</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000038-CTR-000105</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">4.3.2</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Running different applications on the same Kubernetes cluster creates a risk of one
compromised application attacking a neighboring application. Network segmentation is
important to ensure that containers can communicate only with those they are supposed
to. When a network policy is introduced to a given namespace, all traffic not allowed
by the policy is denied. However, if there are no network policies in a namespace all
traffic will be allowed into and out of the pods in that namespace.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#not_ocp4-on-hypershift"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-export export-name="oval:ssg-ocp_data_root:var:1" value-id="xccdf_org.ssgproject.content_value_ocp_data_root"/>
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-configure_network_policies_namespaces:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-configure_network_policies_namespaces_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_configure_network_policy" severity="unknown">
            <xccdf-1.2:title>Ensure Network Policy is Enabled</xccdf-1.2:title>
            <xccdf-1.2:description>Use Network Policy to restrict pod to pod traffic within a cluster and
segregate workloads.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.4.4</xccdf-1.2:reference>
            <xccdf-1.2:rationale>By default, all pod to pod traffic within a cluster is allowed. Network
Policy creates a pod- level firewall that can be used to restrict traffic
between sources. Pod traffic is restricted by having a Network Policy that
selects it (through the use of labels). Once there is any Network Policy in a
namespace selecting a particular pod, that pod will reject any connections
that are not allowed by any Network Policy. Other pods in the namespace that
are not selected by any Network Policy will continue to accept all traffic.

Network Policies are managed via the Kubernetes Network Policy API and
enforced by a network plugin, simply creating the resource without a
compatible network plugin to implement it will have no effect. EKS supports
Network Policy enforcement through the use of Calico.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-88207-6</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-configure_network_policy_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_configure_tls" severity="unknown">
            <xccdf-1.2:title>Encrypt Traffic to Load Balancers and Workloads</xccdf-1.2:title>
            <xccdf-1.2:description>Encrypt traffic to HTTPS load balancers using TLS certificates.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.4.5</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Encrypting traffic between users and your Kubernetes workload is fundamental
to protecting data sent over the web.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-89133-3</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-configure_tls_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_control_plane_access" severity="unknown">
            <xccdf-1.2:title>Restrict Access to the Control Plane Endpoint</xccdf-1.2:title>
            <xccdf-1.2:description>Enable Endpoint Private Access to restrict access to the cluster's control
plane to only an allowlist of authorized IPs.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.4.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Authorized networks are a way of specifying a restricted range of IP
addresses that are permitted to access your cluster's control plane.
Kubernetes Engine uses both Transport Layer Security (TLS) and authentication
to provide secure access to your cluster's control plane from the public
internet. This provides you the flexibility to administer your cluster from
anywhere; however, you might want to further restrict access to a set of IP
addresses that you control. You can set this restriction by specifying an
authorized network. Restricting access to an authorized network can provide
additional security benefits for your container cluster, including:

<html:ul><html:li>Better protection from outsider attacks: Authorized networks provide an
additional layer of security by limiting external access to a specific set
of addresses you designate, such as those that originate from your
premises. This helps protect access to your cluster in the case of a
vulnerability in the cluster's authentication or authorization
mechanism.</html:li><html:li>Better protection from insider attacks: Authorized networks help protect
your cluster from accidental leaks of master certificates from your
company's premises. Leaked certificates used from outside Amazon EC2 and
outside the authorized IP ranges (for example, from addresses outside your
company) are still denied access.</html:li></html:ul>
      </xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-86182-3</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-control_plane_access_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_endpoint_configuration" severity="unknown">
            <xccdf-1.2:title>Ensure Private Endpoint Access</xccdf-1.2:title>
            <xccdf-1.2:description>Disable access to the Kubernetes API from outside the node network if it is
not required.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.4.2</xccdf-1.2:reference>
            <xccdf-1.2:rationale>In a private cluster, the master node has two endpoints, a private and public
endpoint. The private endpoint is the internal IP address of the master,
behind an internal load balancer in the master's VPC network. Nodes
communicate with the master using the private endpoint. The public endpoint
enables the Kubernetes API to be accessed from outside the master's VPC
network.

Although Kubernetes API requires an authorized token to perform sensitive
actions, a vulnerability could potentially expose the Kubernetes publicly
with unrestricted access. Additionally, an attacker may be able to identify
the current cluster and Kubernetes API version and determine whether it is
vulnerable to an attack. Unless required, disabling public endpoint will help
prevent such threats, and require the attacker to be on the master's VPC
network to perform any attack on the Kubernetes API.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-88813-1</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-endpoint_configuration_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_private_nodes" severity="unknown">
            <xccdf-1.2:title>Ensure Cluster Private Nodes</xccdf-1.2:title>
            <xccdf-1.2:description>Disable public IP addresses for cluster nodes, so that they only have private
IP addresses. Private Nodes are nodes with no public IP addresses.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.4.3</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Disabling public IP addresses on cluster nodes restricts access to only
internal networks, forcing attackers to obtain local network access before
attempting to compromise the underlying Kubernetes hosts.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-88669-7</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-private_nodes_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_registry">
          <xccdf-1.2:title>Kubernetes - Registry Security Practices</xccdf-1.2:title>
          <xccdf-1.2:description>Contains evaluations for Kubernetes registry security practices, and cluster-wide registry configuration.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_approved_registries" severity="unknown">
            <xccdf-1.2:title>Only use approved container registries</xccdf-1.2:title>
            <xccdf-1.2:description>Use approved container registries.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.1.4</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Allowing unrestricted access to external container registries provides the
opportunity for malicious or unapproved containers to be deployed into the
cluster. Allowlisting only approved container registries reduces this risk.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-86901-6</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-approved_registries_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_image_scanning" severity="unknown">
            <xccdf-1.2:title>Ensure Image Vulnerability Scanning</xccdf-1.2:title>
            <xccdf-1.2:description>Scan images being deployed to Amazon EKS for vulnerabilities.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.1.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Vulnerabilities in software packages can be exploited by hackers or malicious
users to obtain unauthorized access to local cloud resources. Amazon ECR and
other third party products allow images to be scanned for known
vulnerabilities.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-88990-7</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-image_scanning_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_read_only_registry_access" severity="unknown">
            <xccdf-1.2:title>Ensure Cluster Service Account with read-only access to Amazon ECR</xccdf-1.2:title>
            <xccdf-1.2:description>Configure the Cluster Service Account with Storage Object Viewer Role to only
allow read- only access to Amazon ECR.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.1.3</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The Cluster Service Account does not require administrative access to Amazon
ECR, only requiring pull access to containers to deploy onto Amazon EKS.
Restricting permissions follows the principles of least privilege and
prevents credentials from being abused beyond the required role.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-86681-4</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-read_only_registry_access_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_registry_access" severity="unknown">
            <xccdf-1.2:title>Minimize user access to Amazon ECR</xccdf-1.2:title>
            <xccdf-1.2:description>Restrict user access to Amazon ECR, limiting interaction with build images to
only authorized personnel and service accounts.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.1.2</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Weak access control to Amazon ECR may allow malicious users to replace built
images with vulnerable containers.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-89643-1</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-registry_access_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_secrets">
          <xccdf-1.2:title>Kubernetes Secrets Management</xccdf-1.2:title>
          <xccdf-1.2:description>Secrets let you store and manage sensitive information,
such as passwords, OAuth tokens, and ssh keys.
Such information might otherwise be put in a Pod
specification or in an image.		</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_secret_encryption" severity="unknown">
            <xccdf-1.2:title>Ensure Kubernetes Secrets are Encrypted</xccdf-1.2:title>
            <xccdf-1.2:description>Encrypt Kubernetes secrets, stored in etcd, using secrets encryption feature
during Amazon EKS cluster creation.</xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">5.3.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>Kubernetes can store secrets that pods can access via a mounted volume.
Today, Kubernetes secrets are stored with Base64 encoding, but encrypting is
the recommended approach. Amazon EKS clusters version 1.13 and higher support
the capability of encrypting your Kubernetes secrets using AWS Key Management
Service (KMS) Customer Managed Keys (CMK). The only requirement is to enable
the encryption provider support during EKS cluster creation.

Use AWS Key Management Service (KMS) keys to provide envelope encryption of
Kubernetes secrets stored in Amazon EKS. Implementing envelope encryption is
considered a security best practice for applications that store sensitive
data and is part of a defense in depth security strategy.

Application-layer Secrets Encryption provides an additional layer of security
for sensitive data, such as user defined Secrets and Secrets required for the
operation of the cluster, such as service account keys, which are all stored
in etcd.

Using this functionality, you can use a key, that you manage in AWS KMS, to
encrypt data at the application layer. This protects against attackers in the
event that they manage to gain access to etcd.</xccdf-1.2:rationale>
            <xccdf-1.2:ident system="https://ncp.nist.gov/cce">CCE-90708-9</xccdf-1.2:ident>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-secret_encryption_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
        <xccdf-1.2:Group id="xccdf_org.ssgproject.content_group_worker">
          <xccdf-1.2:title>Kubernetes - Worker Node Settings</xccdf-1.2:title>
          <xccdf-1.2:description>Contains evaluations for the worker node configuration settings.</xccdf-1.2:description>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_file_groupowner_kubelet_conf" severity="medium">
            <xccdf-1.2:title>Verify Group Who Owns The Kubelet Configuration File</xccdf-1.2:title>
            <xccdf-1.2:description> To properly set the group owner of <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>, run the command: <html:pre>$ sudo chgrp root /etc/kubernetes/kubelet/kubelet-config.json</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.1.4</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The kubelet configuration file contains information about the configuration of the
OpenShift node that is configured on the system. Protection of this file is
critical for OpenShift security.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-file_groupowner_kubelet_conf:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-file_groupowner_kubelet_conf_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_file_groupowner_worker_kubeconfig" severity="medium">
            <xccdf-1.2:title>Verify Group Who Owns The Worker Kubeconfig File</xccdf-1.2:title>
            <xccdf-1.2:description> To properly set the group owner of <html:code>/var/lib/kubelet/kubeconfig</html:code>, run the command: <html:pre>$ sudo chgrp root /var/lib/kubelet/kubeconfig</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The worker kubeconfig file contains information about the administrative configuration of the
OpenShift cluster that is configured on the system. Protection of this file is
critical for OpenShift security.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-file_groupowner_worker_kubeconfig:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-file_groupowner_worker_kubeconfig_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_file_owner_kubelet_conf" severity="medium">
            <xccdf-1.2:title>Verify User Who Owns The Kubelet Configuration File</xccdf-1.2:title>
            <xccdf-1.2:description> To properly set the owner of <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>, run the command: <html:pre>$ sudo chown root /etc/kubernetes/kubelet/kubelet-config.json </html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.1.4</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The kubelet configuration file contains information about the configuration of the
OpenShift node that is configured on the system. Protection of this file is
critical for OpenShift security.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-file_owner_kubelet_conf:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-file_owner_kubelet_conf_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_file_owner_worker_kubeconfig" severity="medium">
            <xccdf-1.2:title>Verify User Who Owns The Worker Kubeconfig File</xccdf-1.2:title>
            <xccdf-1.2:description> To properly set the owner of <html:code>/var/lib/kubelet/kubeconfig</html:code>, run the command: <html:pre>$ sudo chown root /var/lib/kubelet/kubeconfig </html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.1.2</xccdf-1.2:reference>
            <xccdf-1.2:rationale>The worker kubeconfig file contains information about the administrative configuration of the
OpenShift cluster that is configured on the system. Protection of this file is
critical for OpenShift security.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-file_owner_worker_kubeconfig:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-file_owner_worker_kubeconfig_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_file_permissions_kubelet_conf" severity="medium">
            <xccdf-1.2:title>Verify Permissions on The Kubelet Configuration File</xccdf-1.2:title>
            <xccdf-1.2:description>
To properly set the permissions of <html:code>/etc/kubernetes/kubelet/kubelet-config.json</html:code>, run the command:
<html:pre>$ sudo chmod 0644 /etc/kubernetes/kubelet/kubelet-config.json</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.1.3</xccdf-1.2:reference>
            <xccdf-1.2:rationale>If the kubelet configuration file is writable by a group-owner or the
world the risk of its compromise is increased. The file contains the configuration of
an OpenShift node that is configured on the system. Protection of this file is
critical for OpenShift security.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-file_permissions_kubelet_conf:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-file_permissions_kubelet_conf_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
          <xccdf-1.2:Rule selected="false" id="xccdf_org.ssgproject.content_rule_file_permissions_worker_kubeconfig" severity="medium">
            <xccdf-1.2:title>Verify Permissions on the Worker Kubeconfig File</xccdf-1.2:title>
            <xccdf-1.2:description>
To properly set the permissions of <html:code>/var/lib/kubelet/kubeconfig</html:code>, run the command:
<html:pre>$ sudo chmod 0644 /var/lib/kubelet/kubeconfig</html:pre>
      </xccdf-1.2:description>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-003-8 R6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-004-6 R3</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx">CIP-007-3 R6.1</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6</xccdf-1.2:reference>
            <xccdf-1.2:reference href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf">CM-6(1)</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform">SRG-APP-000516-CTR-001325</xccdf-1.2:reference>
            <xccdf-1.2:reference href="https://www.cisecurity.org/benchmark/kubernetes/">3.1.1</xccdf-1.2:reference>
            <xccdf-1.2:rationale>If the worker kubeconfig file is writable by a group-owner or the
world the risk of its compromise is increased. The file contains the administration configuration of the
OpenShift cluster that is configured on the system. Protection of this file is
critical for OpenShift security.</xccdf-1.2:rationale>
            <xccdf-1.2:platform idref="#eks-node"/>
            <xccdf-1.2:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
              <xccdf-1.2:check-content-ref href="ssg-eks-oval.xml" name="oval:ssg-file_permissions_worker_kubeconfig:def:1"/>
            </xccdf-1.2:check>
            <xccdf-1.2:check system="http://scap.nist.gov/schema/ocil/2">
              <xccdf-1.2:check-content-ref href="ssg-eks-ocil.xml" name="ocil:ssg-file_permissions_worker_kubeconfig_ocil:questionnaire:1"/>
            </xccdf-1.2:check>
          </xccdf-1.2:Rule>
        </xccdf-1.2:Group>
      </xccdf-1.2:Group>
    </xccdf-1.2:Benchmark>
  </ds:component>
  <ds:component id="scap_org.open-scap_comp_ssg-eks-oval.xml" timestamp="2024-05-16T18:06:55">
    <oval-def:oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
      <oval-def:generator>
        <oval:product_name>OVALFileLinker from SCAP Security Guide</oval:product_name>
        <oval:product_version>ssg: [0, 1, 73], python: 3.12.3</oval:product_version>
        <oval:schema_version>5.11</oval:schema_version>
        <oval:timestamp>2024-05-16T18:04:42</oval:timestamp>
      </oval-def:generator>
      <oval-def:definitions>
        <oval-def:definition id="oval:ssg-configure_network_policies_namespaces:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Ensure that application Namespaces have Network Policies defined.</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="configure_network_policies_namespaces" source="ssg"/>
            <oval-def:description>Ensure that application Namespaces have Network Policies defined</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Make sure that the file '/apis/networking.k8s.io/v1/networkpolicies#51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300 exists." test_ref="oval:ssg-test_file_for_configure_network_policies_namespaces:tst:1"/>
            <oval-def:criterion comment="Make sure that the file '/api/v1/namespaces#34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d' exists." test_ref="oval:ssg-test_file_for_configure_network_policies_filtered_namespaces:tst:1"/>
            <oval-def:criterion comment="Make sure that all target elements exists for elements at path '.items[:].spec.host'" test_ref="oval:ssg-test_elements_count_for_configure_network_policies_namespaces:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-file_groupowner_kubelet_conf:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Verify Group Who Owns The Kubelet Configuration File</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="file_groupowner_kubelet_conf" source="ssg"/>
            <oval-def:description>This test makes sure that /etc/kubernetes/kubelet/kubelet-config.json is group owned by 0.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Check file group ownership of /etc/kubernetes/kubelet/kubelet-config.json" test_ref="oval:ssg-test_file_groupowner_kubelet_conf_0:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-file_groupowner_worker_kubeconfig:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Verify Group Who Owns The Worker Kubeconfig File</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="file_groupowner_worker_kubeconfig" source="ssg"/>
            <oval-def:description>This test makes sure that /var/lib/kubelet/kubeconfig is group owned by 0.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Check file group ownership of /var/lib/kubelet/kubeconfig" test_ref="oval:ssg-test_file_groupowner_worker_kubeconfig_0:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-file_owner_kubelet_conf:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Verify User Who Owns The Kubelet Configuration File</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="file_owner_kubelet_conf" source="ssg"/>
            <oval-def:description>This test makes sure that /etc/kubernetes/kubelet/kubelet-config.json is owned by 0.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Check file ownership of /etc/kubernetes/kubelet/kubelet-config.json" test_ref="oval:ssg-test_file_owner_kubelet_conf_0:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-file_owner_worker_kubeconfig:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Verify User Who Owns The Worker Kubeconfig File</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="file_owner_worker_kubeconfig" source="ssg"/>
            <oval-def:description>This test makes sure that /var/lib/kubelet/kubeconfig is owned by 0.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Check file ownership of /var/lib/kubelet/kubeconfig" test_ref="oval:ssg-test_file_owner_worker_kubeconfig_0:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-file_permissions_kubelet_conf:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Verify Permissions on The Kubelet Configuration File</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="file_permissions_kubelet_conf" source="ssg"/>
            <oval-def:description>This test makes sure that /etc/kubernetes/kubelet/kubelet-config.json has mode 0644.
      If the target file or directory has an extended ACL, then it will fail the mode check.
      </oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Check file mode of /etc/kubernetes/kubelet/kubelet-config.json" test_ref="oval:ssg-test_file_permissions_kubelet_conf_0:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-file_permissions_worker_kubeconfig:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Verify Permissions on the Worker Kubeconfig File</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="file_permissions_worker_kubeconfig" source="ssg"/>
            <oval-def:description>This test makes sure that /var/lib/kubelet/kubeconfig has mode 0644.
      If the target file or directory has an extended ACL, then it will fail the mode check.
      </oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Check file mode of /var/lib/kubelet/kubeconfig" test_ref="oval:ssg-test_file_permissions_worker_kubeconfig_0:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_anonymous_auth:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Disable Anonymous Authentication to the Kubelet</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_anonymous_auth" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.authentication.anonymous.enabled' all: value equals 'false'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.authentication.anonymous.enabled' all" test_ref="oval:ssg-test_kubelet_anonymous_auth:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_authorization_mode:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>Ensure authorization is set to Webhook</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_authorization_mode" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.authorization.mode' all: value equals 'AlwaysAllow'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.authorization.mode' all" test_ref="oval:ssg-test_kubelet_authorization_mode:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_configure_client_ca:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Configure the Client CA Certificate</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_configure_client_ca" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.authentication.x509.clientCAFile' all: value equals '/etc/kubernetes/pki/ca.crt'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.authentication.x509.clientCAFile' all" test_ref="oval:ssg-test_kubelet_configure_client_ca:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_disable_hostname_override:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Hostname Override handling</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_disable_hostname_override" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.hostname-override' all: value equals '.*'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.hostname-override' all" test_ref="oval:ssg-test_kubelet_disable_hostname_override:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_cert_rotation:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Enable Certificate Rotation</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_cert_rotation" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.rotateCertificates' all: value equals 'true'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.rotateCertificates' all" test_ref="oval:ssg-test_kubelet_enable_cert_rotation:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_client_cert_rotation:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Enable Client Certificate Rotation</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_client_cert_rotation" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.featureGates.RotateKubeletClientCertificate' all: value equals 'false'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.featureGates.RotateKubeletClientCertificate' all" test_ref="oval:ssg-test_kubelet_enable_client_cert_rotation:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_iptables_util_chains:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Allow Automatic Firewall Configuration</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_iptables_util_chains" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.makeIPTablesUtilChains' all: value equals 'true'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.makeIPTablesUtilChains' all" test_ref="oval:ssg-test_kubelet_enable_iptables_util_chains:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_protect_kernel_defaults:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Enable Protect Kernel Defaults</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_protect_kernel_defaults" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.protectKernelDefaults' all: value equals 'true'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.protectKernelDefaults' all" test_ref="oval:ssg-test_kubelet_enable_protect_kernel_defaults:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_server_cert_rotation:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Enable Server Certificate Rotation</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_server_cert_rotation" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.serverTLSBootstrap' all: value equals 'true'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.serverTLSBootstrap' all" test_ref="oval:ssg-test_kubelet_enable_server_cert_rotation:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_streaming_connections:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Do Not Disable Streaming Timeouts</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_streaming_connections" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.streamingConnectionIdleTimeout' all: value equals '0s'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.streamingConnectionIdleTimeout' all" test_ref="oval:ssg-test_kubelet_enable_streaming_connections:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_enable_streaming_connections_deprecated:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Do Not Disable Streaming Timeouts</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_enable_streaming_connections_deprecated" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/kubelet/kubelet-config.json' at path '.streamingConnectionIdleTimeout' all: </oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/kubelet/kubelet-config.json' at path '.streamingConnectionIdleTimeout' all" test_ref="oval:ssg-test_kubelet_enable_streaming_connections_deprecated:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-kubelet_read_only_port_secured:def:1" version="1" class="compliance">
          <oval-def:metadata>
            <oval-def:title>kubelet - Ensure that the --read-only-port is secured</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="kubelet_read_only_port_secured" source="ssg"/>
            <oval-def:description>In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.readOnlyPort' all: value equals '0'</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="In the YAML/JSON file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' at path '.kubeletconfig.readOnlyPort' all" test_ref="oval:ssg-test_kubelet_read_only_port_secured:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
      </oval-def:definitions>
      <oval-def:tests>
        <unix:file_test id="oval:ssg-test_file_for_configure_network_policies_namespaces:tst:1" version="1" check="all" comment="Find the file to be checked ('/apis/networking.k8s.io/v1/networkpolicies#51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300')." check_existence="only_one_exists" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_for_configure_network_policies_namespaces:obj:1"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg-test_file_for_configure_network_policies_filtered_namespaces:tst:1" version="1" check="all" comment="Find the file to be checked ('/api/v1/namespaces#34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d')." check_existence="only_one_exists" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_for_configure_network_policies_filtered_namespaces:obj:1"/>
        </unix:file_test>
        <ind:variable_test id="oval:ssg-test_elements_count_for_configure_network_policies_namespaces:tst:1" version="1" check="all" comment="Count elements at both paths and compare" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_elements_count_for_configure_network_policies_namespaces:obj:1"/>
          <ind:state state_ref="oval:ssg-state_elements_count_for_configure_network_policies_namespaces:ste:1"/>
        </ind:variable_test>
        <unix:file_test id="oval:ssg-test_file_groupowner_kubelet_conf_0:tst:1" version="1" check="all" comment="Testing group ownership of /etc/kubernetes/kubelet/kubelet-config.json" check_existence="none_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_groupowner_kubelet_conf_0:obj:1"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg-test_file_groupowner_worker_kubeconfig_0:tst:1" version="1" check="all" comment="Testing group ownership of /var/lib/kubelet/kubeconfig" check_existence="none_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_groupowner_worker_kubeconfig_0:obj:1"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg-test_file_owner_kubelet_conf_0:tst:1" version="1" check="all" comment="Testing user ownership of /etc/kubernetes/kubelet/kubelet-config.json" check_existence="none_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_owner_kubelet_conf_0:obj:1"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg-test_file_owner_worker_kubeconfig_0:tst:1" version="1" check="all" comment="Testing user ownership of /var/lib/kubelet/kubeconfig" check_existence="none_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_owner_worker_kubeconfig_0:obj:1"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg-test_file_permissions_kubelet_conf_0:tst:1" version="3" check="all" comment="Testing mode of /etc/kubernetes/kubelet/kubelet-config.json" check_existence="none_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_permissions_kubelet_conf_0:obj:1"/>
        </unix:file_test>
        <unix:file_test id="oval:ssg-test_file_permissions_worker_kubeconfig_0:tst:1" version="3" check="all" comment="Testing mode of /var/lib/kubelet/kubeconfig" check_existence="none_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_permissions_worker_kubeconfig_0:obj:1"/>
        </unix:file_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_anonymous_auth:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.authentication.anonymous.enabled'." check_existence="all_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_anonymous_auth:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_anonymous_auth:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_authorization_mode:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.authorization.mode'." check_existence="all_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_authorization_mode:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_authorization_mode:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_configure_client_ca:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.authentication.x509.clientCAFile'." check_existence="all_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_configure_client_ca:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_configure_client_ca:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_disable_hostname_override:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.hostname-override'." check_existence="none_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_disable_hostname_override:obj:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_cert_rotation:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.rotateCertificates'." check_existence="all_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_cert_rotation:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_cert_rotation:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_client_cert_rotation:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.featureGates.RotateKubeletClientCertificate'." check_existence="any_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_client_cert_rotation:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_client_cert_rotation:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_iptables_util_chains:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.makeIPTablesUtilChains'." check_existence="only_one_exists" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_iptables_util_chains:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_iptables_util_chains:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_protect_kernel_defaults:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.protectKernelDefaults'." check_existence="only_one_exists" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_protect_kernel_defaults:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_protect_kernel_defaults:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_server_cert_rotation:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.serverTLSBootstrap'." check_existence="only_one_exists" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_server_cert_rotation:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_server_cert_rotation:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_streaming_connections:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.streamingConnectionIdleTimeout'." check_existence="all_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_streaming_connections:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_streaming_connections:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_enable_streaming_connections_deprecated:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/kubelet/kubelet-config.json' find only one object at path '.streamingConnectionIdleTimeout'." check_existence="all_exist" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_enable_streaming_connections_deprecated:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_enable_streaming_connections_deprecated:ste:1"/>
        </ind:yamlfilecontent_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_kubelet_read_only_port_secured:tst:1" version="1" check="all" comment="In the file '/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig' find only one object at path '.kubeletconfig.readOnlyPort'." check_existence="only_one_exists" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_kubelet_read_only_port_secured:obj:1"/>
          <ind:state state_ref="oval:ssg-state_kubelet_read_only_port_secured:ste:1"/>
        </ind:yamlfilecontent_test>
      </oval-def:tests>
      <oval-def:objects>
        <unix:file_object id="oval:ssg-object_file_for_configure_network_policies_namespaces:obj:1" version="1">
          <unix:filepath var_ref="oval:ssg-configure_network_policies_namespaces_file_location:var:1"/>
        </unix:file_object>
        <unix:file_object id="oval:ssg-object_file_for_configure_network_policies_filtered_namespaces:obj:1" version="1">
          <unix:filepath var_ref="oval:ssg-configure_network_policies_filtered_namespaces_file_location:var:1"/>
        </unix:file_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_configure_network_policies_namespaces:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-configure_network_policies_namespaces_file_location:var:1"/>
          <ind:yamlpath>[:]</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_configure_network_policies_filtered_namespaces:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-configure_network_policies_filtered_namespaces_file_location:var:1"/>
          <ind:yamlpath>[:].metadata.name</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:variable_object id="oval:ssg-object_elements_count_for_configure_network_policies_namespaces:obj:1" version="1">
          <ind:var_ref>oval:ssg-local_variable_counter_configure_network_policies_namespaces:var:1</ind:var_ref>
        </ind:variable_object>
        <unix:file_object id="oval:ssg-object_file_groupowner_kubelet_conf_0:obj:1" version="1" comment="/etc/kubernetes/kubelet/kubelet-config.json">
          <unix:filepath>/etc/kubernetes/kubelet/kubelet-config.json</unix:filepath>
          <oval-def:filter action="exclude">oval:ssg-symlink_file_groupowner_kubelet_conf_uid_0:ste:1</oval-def:filter>
          <oval-def:filter action="exclude">oval:ssg-state_file_groupowner_kubelet_conf_gid_0_0:ste:1</oval-def:filter>
        </unix:file_object>
        <unix:file_object id="oval:ssg-object_file_groupowner_worker_kubeconfig_0:obj:1" version="1" comment="/var/lib/kubelet/kubeconfig">
          <unix:filepath>/var/lib/kubelet/kubeconfig</unix:filepath>
          <oval-def:filter action="exclude">oval:ssg-symlink_file_groupowner_worker_kubeconfig_uid_0:ste:1</oval-def:filter>
          <oval-def:filter action="exclude">oval:ssg-state_file_groupowner_worker_kubeconfig_gid_0_0:ste:1</oval-def:filter>
        </unix:file_object>
        <unix:file_object id="oval:ssg-object_file_owner_kubelet_conf_0:obj:1" version="1" comment="/etc/kubernetes/kubelet/kubelet-config.json">
          <unix:filepath>/etc/kubernetes/kubelet/kubelet-config.json</unix:filepath>
          <oval-def:filter action="exclude">oval:ssg-symlink_file_owner_kubelet_conf_uid_0:ste:1</oval-def:filter>
          <oval-def:filter action="exclude">oval:ssg-state_file_owner_kubelet_conf_uid_0_0:ste:1</oval-def:filter>
        </unix:file_object>
        <unix:file_object id="oval:ssg-object_file_owner_worker_kubeconfig_0:obj:1" version="1" comment="/var/lib/kubelet/kubeconfig">
          <unix:filepath>/var/lib/kubelet/kubeconfig</unix:filepath>
          <oval-def:filter action="exclude">oval:ssg-symlink_file_owner_worker_kubeconfig_uid_0:ste:1</oval-def:filter>
          <oval-def:filter action="exclude">oval:ssg-state_file_owner_worker_kubeconfig_uid_0_0:ste:1</oval-def:filter>
        </unix:file_object>
        <unix:file_object id="oval:ssg-object_file_permissions_kubelet_conf_0:obj:1" version="1" comment="/etc/kubernetes/kubelet/kubelet-config.json">
          <unix:filepath>/etc/kubernetes/kubelet/kubelet-config.json</unix:filepath>
          <oval-def:filter action="exclude">oval:ssg-exclude_symlinks__kubelet_conf:ste:1</oval-def:filter>
          <oval-def:filter action="exclude">oval:ssg-state_file_permissions_kubelet_conf_0_mode_0644or_stricter_:ste:1</oval-def:filter>
        </unix:file_object>
        <unix:file_object id="oval:ssg-object_file_permissions_worker_kubeconfig_0:obj:1" version="1" comment="/var/lib/kubelet/kubeconfig">
          <unix:filepath>/var/lib/kubelet/kubeconfig</unix:filepath>
          <oval-def:filter action="exclude">oval:ssg-exclude_symlinks__worker_kubeconfig:ste:1</oval-def:filter>
          <oval-def:filter action="exclude">oval:ssg-state_file_permissions_worker_kubeconfig_0_mode_0644or_stricter_:ste:1</oval-def:filter>
        </unix:file_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_anonymous_auth:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_anonymous_auth_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.authentication.anonymous.enabled</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_authorization_mode:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_authorization_mode_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.authorization.mode</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_configure_client_ca:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_configure_client_ca_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.authentication.x509.clientCAFile</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_disable_hostname_override:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_disable_hostname_override_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.hostname-override</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_cert_rotation:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_cert_rotation_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.rotateCertificates</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_client_cert_rotation:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_client_cert_rotation_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.featureGates.RotateKubeletClientCertificate</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_iptables_util_chains:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_iptables_util_chains_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.makeIPTablesUtilChains</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_protect_kernel_defaults:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_protect_kernel_defaults_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.protectKernelDefaults</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_server_cert_rotation:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_server_cert_rotation_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.serverTLSBootstrap</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_streaming_connections:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_streaming_connections_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.streamingConnectionIdleTimeout</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_enable_streaming_connections_deprecated:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_enable_streaming_connections_deprecated_file_location:var:1"/>
          <ind:yamlpath>.streamingConnectionIdleTimeout</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_kubelet_read_only_port_secured:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-kubelet_read_only_port_secured_file_location:var:1"/>
          <ind:yamlpath>.kubeletconfig.readOnlyPort</ind:yamlpath>
        </ind:yamlfilecontent_object>
      </oval-def:objects>
      <oval-def:states>
        <ind:variable_state id="oval:ssg-state_elements_count_for_configure_network_policies_namespaces:ste:1" version="1" operator="AND">
          <ind:value datatype="int" var_ref="oval:ssg-local_variable_counter_configure_network_policies_filtered_namespaces:var:1"/>
        </ind:variable_state>
        <unix:file_state id="oval:ssg-state_file_groupowner_kubelet_conf_gid_0_0:ste:1" version="1" operator="AND">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg-symlink_file_groupowner_kubelet_conf_uid_0:ste:1" version="1" operator="AND">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg-state_file_groupowner_worker_kubeconfig_gid_0_0:ste:1" version="1" operator="AND">
          <unix:group_id datatype="int">0</unix:group_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg-symlink_file_groupowner_worker_kubeconfig_uid_0:ste:1" version="1" operator="AND">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg-state_file_owner_kubelet_conf_uid_0_0:ste:1" version="1" operator="AND">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg-symlink_file_owner_kubelet_conf_uid_0:ste:1" version="1" operator="AND">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg-state_file_owner_worker_kubeconfig_uid_0_0:ste:1" version="1" operator="AND">
          <unix:user_id datatype="int">0</unix:user_id>
        </unix:file_state>
        <unix:file_state id="oval:ssg-symlink_file_owner_worker_kubeconfig_uid_0:ste:1" version="1" operator="AND">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg-state_file_permissions_kubelet_conf_0_mode_0644or_stricter_:ste:1" version="3" operator="AND">
          <unix:suid datatype="boolean">false</unix:suid>
          <unix:sgid datatype="boolean">false</unix:sgid>
          <unix:sticky datatype="boolean">false</unix:sticky>
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <unix:file_state id="oval:ssg-exclude_symlinks__kubelet_conf:ste:1" version="1" operator="AND">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <unix:file_state id="oval:ssg-state_file_permissions_worker_kubeconfig_0_mode_0644or_stricter_:ste:1" version="3" operator="AND">
          <unix:suid datatype="boolean">false</unix:suid>
          <unix:sgid datatype="boolean">false</unix:sgid>
          <unix:sticky datatype="boolean">false</unix:sticky>
          <unix:uexec datatype="boolean">false</unix:uexec>
          <unix:gwrite datatype="boolean">false</unix:gwrite>
          <unix:gexec datatype="boolean">false</unix:gexec>
          <unix:owrite datatype="boolean">false</unix:owrite>
          <unix:oexec datatype="boolean">false</unix:oexec>
        </unix:file_state>
        <unix:file_state id="oval:ssg-exclude_symlinks__worker_kubeconfig:ste:1" version="1" operator="AND">
          <unix:type operation="equals">symbolic link</unix:type>
        </unix:file_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_anonymous_auth:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">false</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_authorization_mode:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="not equal">AlwaysAllow</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_configure_client_ca:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">/etc/kubernetes/pki/ca.crt</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_cert_rotation:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">true</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_client_cert_rotation:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="not equal">false</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_iptables_util_chains:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">true</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_protect_kernel_defaults:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">true</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_server_cert_rotation:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">true</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_streaming_connections:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="not equal">0s</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_enable_streaming_connections_deprecated:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="pattern match" var_ref="oval:ssg-var_streaming_connection_timeouts:var:1"/>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_kubelet_read_only_port_secured:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" operation="equals">0</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
      </oval-def:states>
      <oval-def:variables>
        <oval-def:external_variable id="oval:ssg-ocp_data_root:var:1" version="1" datatype="string" comment="Root of OCP data dump"/>
        <oval-def:local_variable id="oval:ssg-configure_network_policies_namespaces_file_location:var:1" version="1" datatype="string" comment="Path of file containing filtered non-ctlplane namespaces with network policies.">
          <oval-def:concat>
            <oval-def:variable_component var_ref="oval:ssg-ocp_data_root:var:1"/>
            <oval-def:literal_component>/apis/networking.k8s.io/v1/networkpolicies#51742b3e87275db9eb7fc6c0286a9e536178a2a83e3670b615ceaf545e7fd300</oval-def:literal_component>
          </oval-def:concat>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-configure_network_policies_filtered_namespaces_file_location:var:1" version="1" datatype="string" comment="Path of file containing filtered non-ctlplane namespaces.">
          <oval-def:concat>
            <oval-def:variable_component var_ref="oval:ssg-ocp_data_root:var:1"/>
            <oval-def:literal_component>/api/v1/namespaces#34d4beecc95c65d815d9d48fd4fdcb0c521631852ad088ef74e36d012b0e1e0d</oval-def:literal_component>
          </oval-def:concat>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-local_variable_counter_configure_network_policies_namespaces:var:1" version="1" datatype="int" comment="Items counter">
          <oval-def:count>
            <oval-def:object_component object_ref="oval:ssg-object_configure_network_policies_namespaces:obj:1" item_field="value" record_field="#"/>
          </oval-def:count>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-local_variable_counter_configure_network_policies_filtered_namespaces:var:1" version="1" datatype="int" comment="Items counter control">
          <oval-def:count>
            <oval-def:object_component object_ref="oval:ssg-object_configure_network_policies_filtered_namespaces:obj:1" item_field="value" record_field="#"/>
          </oval-def:count>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_anonymous_auth_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_authorization_mode_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_configure_client_ca_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_disable_hostname_override_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_cert_rotation_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_client_cert_rotation_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_iptables_util_chains_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_protect_kernel_defaults_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_server_cert_rotation_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_streaming_connections_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-kubelet_enable_streaming_connections_deprecated_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/kubelet/kubelet-config.json</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:external_variable id="oval:ssg-var_streaming_connection_timeouts:var:1" version="1" datatype="string" comment="variable"/>
        <oval-def:local_variable id="oval:ssg-kubelet_read_only_port_secured_file_location:var:1" version="1" datatype="string" comment="The actual path of the file to scan.">
          <oval-def:literal_component>/etc/kubernetes/compliance-operator/kubeletconfig/openscap-kubeletconfig</oval-def:literal_component>
        </oval-def:local_variable>
      </oval-def:variables>
    </oval-def:oval_definitions>
  </ds:component>
  <ds:component id="scap_org.open-scap_comp_ssg-eks-ocil.xml" timestamp="2024-05-16T18:06:54">
    <ocil:ocil>
      <ocil:generator>
        <ocil:product_name>build_shorthand.py from SCAP Security Guide</ocil:product_name>
        <ocil:product_version>ssg: 0.1.73</ocil:product_version>
        <ocil:schema_version>2.0</ocil:schema_version>
        <ocil:timestamp>2024-05-16T18:04:42</ocil:timestamp>
      </ocil:generator>
      <ocil:questionnaires>
        <ocil:questionnaire id="ocil:ssg-configure_network_policies_namespaces_ocil:questionnaire:1">
          <ocil:title>Ensure that application Namespaces have Network Policies defined.</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-configure_network_policies_namespaces_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-dedicated_service_accounts_ocil:questionnaire:1">
          <ocil:title>Use Dedicated Service Accounts</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-dedicated_service_accounts_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_streaming_connections_ocil:questionnaire:1">
          <ocil:title>kubelet - Do Not Disable Streaming Timeouts</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_streaming_connections_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-private_nodes_ocil:questionnaire:1">
          <ocil:title>Ensure Cluster Private Nodes</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-private_nodes_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-endpoint_configuration_ocil:questionnaire:1">
          <ocil:title>Ensure Private Endpoint Access</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-endpoint_configuration_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-iam_integration_ocil:questionnaire:1">
          <ocil:title>Manage Users with AWS IAM</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-iam_integration_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-audit_logging_ocil:questionnaire:1">
          <ocil:title>Ensure Audit Logging is Enabled</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-audit_logging_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-secret_encryption_ocil:questionnaire:1">
          <ocil:title>Ensure Kubernetes Secrets are Encrypted</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-secret_encryption_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_protect_kernel_defaults_ocil:questionnaire:1">
          <ocil:title>kubelet - Enable Protect Kernel Defaults</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_protect_kernel_defaults_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_configure_client_ca_ocil:questionnaire:1">
          <ocil:title>kubelet - Configure the Client CA Certificate</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_configure_client_ca_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-file_owner_kubelet_conf_ocil:questionnaire:1">
          <ocil:title>Verify User Who Owns The Kubelet Configuration File</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-file_owner_kubelet_conf_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-file_groupowner_worker_kubeconfig_ocil:questionnaire:1">
          <ocil:title>Verify Group Who Owns The Worker Kubeconfig File</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-file_groupowner_worker_kubeconfig_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_streaming_connections_deprecated_ocil:questionnaire:1">
          <ocil:title>kubelet - Do Not Disable Streaming Timeouts</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_streaming_connections_deprecated_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_server_cert_rotation_ocil:questionnaire:1">
          <ocil:title>kubelet - Enable Server Certificate Rotation</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_server_cert_rotation_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-file_permissions_worker_kubeconfig_ocil:questionnaire:1">
          <ocil:title>Verify Permissions on the Worker Kubeconfig File</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-file_permissions_worker_kubeconfig_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_cert_rotation_ocil:questionnaire:1">
          <ocil:title>kubelet - Enable Certificate Rotation</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_cert_rotation_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-configure_network_policy_ocil:questionnaire:1">
          <ocil:title>Ensure Network Policy is Enabled</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-configure_network_policy_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-file_groupowner_kubelet_conf_ocil:questionnaire:1">
          <ocil:title>Verify Group Who Owns The Kubelet Configuration File</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-file_groupowner_kubelet_conf_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_authorization_mode_ocil:questionnaire:1">
          <ocil:title>Ensure authorization is set to Webhook</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_authorization_mode_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-fargate_ocil:questionnaire:1">
          <ocil:title>Consider Fargate for Untrusted Workloads</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-fargate_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-approved_registries_ocil:questionnaire:1">
          <ocil:title>Only use approved container registries</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-approved_registries_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-image_scanning_ocil:questionnaire:1">
          <ocil:title>Ensure Image Vulnerability Scanning</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-image_scanning_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-file_permissions_kubelet_conf_ocil:questionnaire:1">
          <ocil:title>Verify Permissions on The Kubelet Configuration File</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-file_permissions_kubelet_conf_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_iptables_util_chains_ocil:questionnaire:1">
          <ocil:title>kubelet - Allow Automatic Firewall Configuration</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_iptables_util_chains_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-read_only_registry_access_ocil:questionnaire:1">
          <ocil:title>Ensure Cluster Service Account with read-only access to Amazon ECR</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-read_only_registry_access_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-control_plane_access_ocil:questionnaire:1">
          <ocil:title>Restrict Access to the Control Plane Endpoint</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-control_plane_access_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_read_only_port_secured_ocil:questionnaire:1">
          <ocil:title>kubelet - Ensure that the --read-only-port is secured</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_read_only_port_secured_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-configure_tls_ocil:questionnaire:1">
          <ocil:title>Encrypt Traffic to Load Balancers and Workloads</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-configure_tls_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-registry_access_ocil:questionnaire:1">
          <ocil:title>Minimize user access to Amazon ECR</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-registry_access_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-file_owner_worker_kubeconfig_ocil:questionnaire:1">
          <ocil:title>Verify User Who Owns The Worker Kubeconfig File</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-file_owner_worker_kubeconfig_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_anonymous_auth_ocil:questionnaire:1">
          <ocil:title>Disable Anonymous Authentication to the Kubelet</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_anonymous_auth_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
        <ocil:questionnaire id="ocil:ssg-kubelet_enable_client_cert_rotation_ocil:questionnaire:1">
          <ocil:title>kubelet - Enable Client Certificate Rotation</ocil:title>
          <ocil:actions>
            <ocil:test_action_ref>ocil:ssg-kubelet_enable_client_cert_rotation_action:testaction:1</ocil:test_action_ref>
          </ocil:actions>
        </ocil:questionnaire>
      </ocil:questionnaires>
      <ocil:test_actions>
        <ocil:boolean_question_test_action id="ocil:ssg-configure_network_policies_namespaces_action:testaction:1" question_ref="ocil:ssg-configure_network_policies_namespaces_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-dedicated_service_accounts_action:testaction:1" question_ref="ocil:ssg-dedicated_service_accounts_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_streaming_connections_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_streaming_connections_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-private_nodes_action:testaction:1" question_ref="ocil:ssg-private_nodes_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-endpoint_configuration_action:testaction:1" question_ref="ocil:ssg-endpoint_configuration_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-iam_integration_action:testaction:1" question_ref="ocil:ssg-iam_integration_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-audit_logging_action:testaction:1" question_ref="ocil:ssg-audit_logging_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-secret_encryption_action:testaction:1" question_ref="ocil:ssg-secret_encryption_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_protect_kernel_defaults_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_protect_kernel_defaults_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_configure_client_ca_action:testaction:1" question_ref="ocil:ssg-kubelet_configure_client_ca_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-file_owner_kubelet_conf_action:testaction:1" question_ref="ocil:ssg-file_owner_kubelet_conf_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-file_groupowner_worker_kubeconfig_action:testaction:1" question_ref="ocil:ssg-file_groupowner_worker_kubeconfig_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_streaming_connections_deprecated_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_streaming_connections_deprecated_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_server_cert_rotation_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_server_cert_rotation_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-file_permissions_worker_kubeconfig_action:testaction:1" question_ref="ocil:ssg-file_permissions_worker_kubeconfig_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_cert_rotation_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_cert_rotation_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-configure_network_policy_action:testaction:1" question_ref="ocil:ssg-configure_network_policy_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-file_groupowner_kubelet_conf_action:testaction:1" question_ref="ocil:ssg-file_groupowner_kubelet_conf_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_authorization_mode_action:testaction:1" question_ref="ocil:ssg-kubelet_authorization_mode_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-fargate_action:testaction:1" question_ref="ocil:ssg-fargate_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-approved_registries_action:testaction:1" question_ref="ocil:ssg-approved_registries_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-image_scanning_action:testaction:1" question_ref="ocil:ssg-image_scanning_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-file_permissions_kubelet_conf_action:testaction:1" question_ref="ocil:ssg-file_permissions_kubelet_conf_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_iptables_util_chains_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_iptables_util_chains_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-read_only_registry_access_action:testaction:1" question_ref="ocil:ssg-read_only_registry_access_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-control_plane_access_action:testaction:1" question_ref="ocil:ssg-control_plane_access_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_read_only_port_secured_action:testaction:1" question_ref="ocil:ssg-kubelet_read_only_port_secured_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-configure_tls_action:testaction:1" question_ref="ocil:ssg-configure_tls_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-registry_access_action:testaction:1" question_ref="ocil:ssg-registry_access_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-file_owner_worker_kubeconfig_action:testaction:1" question_ref="ocil:ssg-file_owner_worker_kubeconfig_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_anonymous_auth_action:testaction:1" question_ref="ocil:ssg-kubelet_anonymous_auth_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
        <ocil:boolean_question_test_action id="ocil:ssg-kubelet_enable_client_cert_rotation_action:testaction:1" question_ref="ocil:ssg-kubelet_enable_client_cert_rotation_question:question:1">
          <ocil:when_true>
            <ocil:result>PASS</ocil:result>
          </ocil:when_true>
          <ocil:when_false>
            <ocil:result>FAIL</ocil:result>
          </ocil:when_false>
        </ocil:boolean_question_test_action>
      </ocil:test_actions>
      <ocil:questions>
        <ocil:boolean_question id="ocil:ssg-configure_network_policies_namespaces_question:question:1">
          <ocil:question_text>Verify that the every non-control plane namespace has an appropriate
NetworkPolicy.

To get all the non-control plane namespaces, you can do the
following command oc get  namespaces -o json | jq '[.items[] | select((.metadata.name | startswith("openshift") | not) and (.metadata.name | startswith("kube-") | not) and .metadata.name != "default") | .metadata.name ]'

To get all the non-control plane namespaces with a NetworkPolicy, you can do the
following command oc get --all-namespaces networkpolicies -o json | jq '[.items[] | select((.metadata.namespace | startswith("openshift") | not) and (.metadata.namespace | startswith("kube-") | not) and .metadata.namespace != "default") | .metadata.namespace] | unique'

Make sure that the namespaces displayed in the commands of the commands match.
      Is it the case that Namespaced Network Policies needs review?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-dedicated_service_accounts_question:question:1">
          <ocil:question_text>Audit:

For each namespace in the cluster, review the rights assigned to the default
service account and ensure that it has no roles or cluster roles bound to it
apart from the defaults. Additionally ensure that the
automountServiceAccountToken: false setting is in place for each
default service account.

Remediation:

With IAM roles for service accounts on Amazon EKS clusters, you can associate
an IAM role with a Kubernetes service account. This service account can then
provide AWS permissions to the containers in any pod that uses that service
account. With this feature, you no longer need to provide extended
permissions to the worker node IAM role so that pods on that node can call
AWS APIs.
Applications must sign their AWS API requests with AWS credentials. This
feature provides a strategy for managing credentials for your applications,
similar to the way that Amazon EC2 instance profiles provide credentials to
Amazon EC2 instances. Instead of creating and distributing your AWS
credentials to the containers or using the Amazon EC2 instance’s role, you
can associate an IAM role with a Kubernetes service account. The applications
in the pod’s containers can then use an AWS SDK or the AWS CLI to make API
requests to authorized AWS services.

The IAM roles for service accounts feature provides the following benefits:


  Least privilege — By using the IAM roles for service accounts feature,
  you no longer need to provide extended permissions to the worker node IAM
  role so that pods on that node can call AWS APIs. You can scope IAM
  permissions to a service account, and only pods that use that service
  account have access to those permissions. This feature also eliminates the
  need for third-party solutions such as kiam or kube2iam.
  Credential isolation — A container can only retrieve credentials for
  the IAM role that is associated with the service account to which it
  belongs. A container never has access to credentials that are intended for
  another container that belongs to another pod.
  Auditability — Access and event logging is available through CloudTrail
  to help ensure retrospective auditing.


To get started, see Enabling IAM roles for service accounts on your cluster.
For an end-to-end walkthrough using eksctl, see Walkthrough: Updating
a DaemonSet to use IAM for service accounts.
      Is it the case that dedicated service accounts are used?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_streaming_connections_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep streamingConnectionIdleTimeout; done
The output should not return 0.
      Is it the case that the streaming connection timeouts are not disabled?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-private_nodes_question:question:1">
          <ocil:question_text>To enable Private Nodes, the cluster has to also be configured with a private
master IP range and IP Aliasing enabled. Private Nodes do not have outbound
access to the public internet.

If you want to provide outbound Internet access for your private nodes, you
can use Cloud NAT or you can manage your own NAT gateway.
      Is it the case that clusters are created with private nodes?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-endpoint_configuration_question:question:1">
          <ocil:question_text>Configure the EKS cluster endpoint to be private. See Modifying Cluster
Endpoint Access for further information on this topic.
https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html
      Is it the case that private access is enabled and public access is disabled?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-iam_integration_question:question:1">
          <ocil:question_text>Audit:

To Audit access to the namespace $NAMESPACE, assume the IAM role
yourIAMRoleName for a user that you created, and then run the following
command:

$ kubectl get role -n $NAMESPACE
The response lists the RBAC role that has access to this Namespace.

Remediation:

Refer to the 'Managing users or IAM roles for your cluster' in Amazon EKS
documentation.

https://docs.aws.amazon.com/eks/latest/userguide/add-user-role.html
      Is it the case that authorization and authentication is managed using AWS IAM?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-audit_logging_question:question:1">
          <ocil:question_text>Perform the following to determine if CloudTrail is enabled for all regions:
Via the Management Console
1. Sign in to the AWS Management Console and open the EKS console at https://console.aws.amazon.com/eks
2. Click on Cluster Name of the cluster you are auditing
3. Click Logging
4. Ensure all 5 choices are set to Enabled
Via CLI
aws --region "${REGION_CODE}" eks describe-cluster --name "${CLUSTER_NAME}"  --query 'cluster.logging.clusterLogging[?enabled==true].types'

Perform the following to determine if CloudTrail is enabled for all regions:
Via The Management Console
1. Sign in to the AWS Management Console and open the EKS console at https://console.aws.amazon.com/eks
2. Click on Cluster Name of the cluster you are auditing
3. Click Logging
4. Select Manage Logging from the button on the right hand side
5. Toggle each selection to the Enabled position.
6. Click Save Changes
      Is it the case that audit logging is enable?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-secret_encryption_question:question:1">
          <ocil:question_text>Audit:

For Amazon EKS clusters with Secrets Encryption enabled, look for
'encryptionConfig' configuration when you run:
aws eks describe-cluster --name="cluster-name"

Remediation:

Enable 'Secrets Encryption' during Amazon EKS cluster creation as
described in the links within the 'References' section.

References:

  https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html
  https://eksworkshop.com/beginner/191_secrets/

      Is it the case that kubernetes secrets are encrypted in etcd?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_protect_kernel_defaults_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ sudo grep protectKernelDefaults /etc/kubernetes/kubelet/kubelet-config.json
The output should return true.
      Is it the case that the kubelet can modify kernel parameters?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_configure_client_ca_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep -A1 x509; done
The output should contain a configured certificate like /etc/kubernetes/pki/ca.crt.
      Is it the case that no client CA certificate has been configured?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-file_owner_kubelet_conf_question:question:1">
          <ocil:question_text>To check the ownership of /etc/kubernetes/kubelet/kubelet-config.json,
run the command:
$ ls -lL /etc/kubernetes/kubelet/kubelet-config.json
If properly configured, the output should indicate the following owner:
root
      Is it the case that /etc/kubernetes/kubelet/kubelet-config.json does not have an owner of root?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-file_groupowner_worker_kubeconfig_question:question:1">
          <ocil:question_text>To check the group ownership of /var/lib/kubelet/kubeconfig,
run the command:
$ ls -lL /var/lib/kubelet/kubeconfig
If properly configured, the output should indicate the following group-owner:
root
      Is it the case that /var/lib/kubelet/kubeconfig does not have a group owner of root?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_streaming_connections_deprecated_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ sudo grep streamingConnectionIdleTimeout /etc/kubernetes/kubelet/kubelet-config.json
The output should return .
      Is it the case that the streaming connection timeouts are not disabled?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_server_cert_rotation_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for node in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$node/proxy/configz | jq '.kubeletconfig.serverTLSBootstrap'; done
The output should return true.
      Is it the case that the kubelet cannot rotate server certificate?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-file_permissions_worker_kubeconfig_question:question:1">
          <ocil:question_text>To check the permissions of /var/lib/kubelet/kubeconfig,
run the command:
$ ls -l /var/lib/kubelet/kubeconfig
If properly configured, the output should indicate the following permissions:
-rw-r--r--
      Is it the case that /var/lib/kubelet/kubeconfig does not have unix mode -rw-r--r--?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_cert_rotation_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep rotateCertificates; done
The output should return nothing or true.
      Is it the case that the kubelet cannot rotate client certificate?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-configure_network_policy_question:question:1">
          <ocil:question_text>Network Policy requires the Network Policy add-on. This add-on is included
automatically when a cluster with Network Policy is created, but for an
existing cluster, needs to be added prior to enabling Network Policy.

Enabling/Disabling Network Policy causes a rolling update of all cluster
nodes, similar to performing a cluster upgrade. This operation is
long-running and will block other operations on the cluster (including
delete) until it has run to completion.

If Network Policy is used, a cluster must have at least 2 nodes of type
n1-standard-1 or higher. The recommended minimum size cluster to run
Network Policy enforcement is 3 n1-standard-1 instances.

Enabling Network Policy enforcement consumes additional resources in nodes.
Specifically, it increases the memory footprint of the kube-system
process by approximately 128MB, and requires approximately 300 millicores of
CPU.
      Is it the case that network policy is enabled?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-file_groupowner_kubelet_conf_question:question:1">
          <ocil:question_text>To check the group ownership of /etc/kubernetes/kubelet/kubelet-config.json,
run the command:
$ ls -lL /etc/kubernetes/kubelet/kubelet-config.json
If properly configured, the output should indicate the following group-owner:
root
      Is it the case that /etc/kubernetes/kubelet/kubelet-config.json does not have a group owner of root?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_authorization_mode_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | sudo grep -A1 authorization; done
Verify that the output is not set to mode: AlwaysAllow, or missing
(defaults to mode: Webhook).
      Is it the case that &lt;tt&gt;authorization-mode&lt;/tt&gt; is not configured to &lt;tt&gt;Webhook&lt;/tt&gt;?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-fargate_question:question:1">
          <ocil:question_text>Audit:
Check the existence of Fargate profiles in the Amazon EKS cluster by using:

aws --region ${AWS_REGION} eks list-fargate-profiles --cluster-name ${CLUSTER_NAME}
Alternatively, to audit for the presence of a Fargate profile node run the
following command:
kubectl get nodes
The response should include a NAME entry starting with "fargate-ip" for
example:
NAME STATUS ROLES AGE VERSION
fargate-ip-192-168-104-74.us-east-2.compute.internal Ready 2m15s v1.14.8-eks

Remediation:

Create a Fargate profile for your cluster

Before you can schedule pods running on Fargate in your cluster, you must define a Fargate
profile that specifies which pods should use Fargate when they are launched. For more
information, see AWS Fargate profile.

Note
If you created your cluster with eksctl using the --fargate option,
then a Fargate profile has already been created for your cluster with
selectors for all pods in the kube-system and default namespaces.
Use the following procedure to create Fargate profiles for any other
namespaces you would like to use with Fargate.

via eksctl CLI

Create your Fargate profile with the following eksctl command, replacing the
variable text with your own values. You must specify a namespace, but the
labels option is not required.
eksctl create fargateprofile --cluster cluster_name --name
fargate_profile_name --namespace kubernetes_namespace --labels key=value

via AWS Management Console

To create a Fargate profile for a cluster with the AWS Management Console


  Open the Amazon EKS console at https://console.aws.amazon.com/eks/home#/clusters.
  Choose the cluster to create a Fargate profile for.
  Under Fargate profiles, choose Add Fargate profile.
  On the Configure Fargate profile page, enter the following information
  and choose. For Name, enter a unique name for your Fargate profile. For Pod
  execution role, choose the pod execution role to use with your Fargate
  profile. Only IAM roles with the eks-fargate-pods.amazonaws.com service principal
  are shown. If you do not see any roles listed here, you must create one. For more
  information, see Pod execution role. For Subnets, choose the subnets to use
  for your pods. By default, all subnets in your cluster's VPC are selected.
  Only private subnets are supported for pods running on Fargate; you must
  deselect any public subnets. For Tags, you can optionally tag your Fargate
  profile. These tags do not propagate to other resources associated with the
  profile, such as its pods.
  5. On the Configure pods selection page, enter the following
  information and choose Next. list text hereFor Namespace, enter a namespace
  to match for pods, such as kube-system or default. list text
  here(Optional) Add Kubernetes labels to the selector that pods in the
  specified namespace must have to match the selector. For example, you could
  add the label infrastructure: fargate to the selector so that only pods in
  the specified namespace that also have the infrastructure: fargate
  Kubernetes label match the selector. 
  On the Review and create page, review the information for your Fargate
  profile and choose Create.

      Is it the case that untrusted workloads are isolated?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-approved_registries_question:question:1">
          <ocil:question_text>Ensure all containers and images are coming from approved registries.

References:

https://aws.amazon.com/blogs/opensource/using-open-policy-agent-on-amazon-eks/
      Is it the case that container images come from approved registries?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-image_scanning_question:question:1">
          <ocil:question_text>Please follow AWS ECS or your 3rd party image scanning provider's guidelines
for enabling Image Scanning.

Remediation:

To utilize AWS ECR for Image scanning please follow the steps below:

To create a repository configured for scan on push (AWS CLI)

aws ecr create-repository --repository-name $REPO_NAME --image-scanning- configuration scanOnPush=true --region $REGION_CODE

To edit the settings of an existing repository (AWS CLI)

aws ecr put-image-scanning-configuration --repository-name $REPO_NAME -- image-scanning-configuration scanOnPush=true --region $REGION_CODE

Use the following steps to start a manual image scan using the AWS Management Console.

1. Open the Amazon ECR console at https://console.aws.amazon.com/ecr/repositories.
2. From the navigation bar, choose the Region to create your repository in.
3. In the navigation pane, choose Repositories.
4. On the Repositories page, choose the repository that contains the image to scan.
5. On the Images page, select the image to scan and then choose Scan.
      Is it the case that image vulnerability scanning is enabled?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-file_permissions_kubelet_conf_question:question:1">
          <ocil:question_text>To check the permissions of /etc/kubernetes/kubelet/kubelet-config.json,
run the command:
$ ls -l /etc/kubernetes/kubelet/kubelet-config.json
If properly configured, the output should indicate the following permissions:
-rw-r--r--
      Is it the case that /etc/kubernetes/kubelet/kubelet-config.json does not have unix mode -rw-r--r--?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_iptables_util_chains_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ oc get --raw /api/v1/nodes/${NODE_NAME}/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep makeIPTablesUtilChains 
The output should return true.
      Is it the case that the kubelet cannot modify the firewall settings?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-read_only_registry_access_question:question:1">
          <ocil:question_text>Review AWS ECS worker node IAM role (NodeInstanceRole) IAM Policy Permissions
to verify that they are set and the minimum required level. If utilizing a
3rd party tool to scan images utilize the minimum required permission level
required to interact with the cluster - generally this should be read-only.

Remediation:

You can use your Amazon ECR images with Amazon EKS, but you need to satisfy
the following prerequisites.
The Amazon EKS worker node IAM role (NodeInstanceRole) that you use with your
worker nodes must possess the following IAM policy permissions for Amazon
ECR.


{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "ecr:BatchCheckLayerAvailability",
        "ecr:BatchGetImage",
        "ecr:GetDownloadUrlForLayer",
        "ecr:GetAuthorizationToken"
      ],
      "Resource": "*"
    }
  ]
}

      Is it the case that Cluster Service Account has read-only access to Amazon ECR?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-control_plane_access_question:question:1">
          <ocil:question_text>Audit:
Input:

aws eks describe-cluster \
--region region \
--name clustername
Output:
...
"endpointPublicAccess": false,
"endpointPrivateAccess": true,
"publicAccessCidrs": [
"203.0.113.5/32"
]
...

Remediation:
Complete the following steps using the AWS CLI version 1.18.10 or later. You
can check your current version with aws --version. To install or
upgrade the AWS CLI, see Installing the AWS CLI.

Update your cluster API server endpoint access with the following AWS CLI
command. Substitute your cluster name and desired endpoint access values. If
you set endpointPublicAccess=true, then you can (optionally) enter
single CIDR block, or a comma- separated list of CIDR blocks for
publicAccessCidrs. The blocks cannot include reserved addresses. If you
specify CIDR blocks, then the public API server endpoint will only receive
requests from the listed blocks. There is a maximum number of CIDR blocks
that you can specify. For more information, see Amazon EKS Service Quotas. If
you restrict access to your public endpoint using CIDR blocks, it is
recommended that you also enable private endpoint access so that worker nodes
and Fargate pods (if you use them) can communicate with the cluster. Without
the private endpoint enabled, your public access endpoint CIDR sources must
include the egress sources from your VPC. For example, if you have a worker
node in a private subnet that communicates to the internet through a NAT
Gateway, you will need to add the outbound IP address of the NAT gateway as
part of a whitelisted CIDR block on your public endpoint. If you specify no
CIDR blocks, then the public API server endpoint receives requests from all
(0.0.0.0/0) IP addresses.

Note
The following command enables private access and public access from a single IP address
for the API server endpoint. Replace 203.0.113.5/32 with a single CIDR block, or a comma-
separated list of CIDR blocks that you want to restrict network access to.

Example command:

aws eks update-cluster-config \
--region region-code \
--name dev \
--resources-vpc-config \
endpointPublicAccess=true, \
publicAccessCidrs="203.0.113.5/32",\
endpointPrivateAccess=true
      Is it the case that the control plane endpoint is secure?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_read_only_port_secured_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep readOnlyPort; done
and make sure it outputs 0.
      Is it the case that readOnlyPort is not secured?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-configure_tls_question:question:1">
          <ocil:question_text>For more information about protecting your workloads using TLS please refer
to the AWS User Guide:

https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/data-protection.html
      Is it the case that connections to load balancers and workloads are encrypted with TLS?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-registry_access_question:question:1">
          <ocil:question_text>Remediation:

Before you use IAM to manage access to Amazon ECR, you should understand what
IAM features are available to use with Amazon ECR. To get a high-level view
of how Amazon ECR and other AWS services work with IAM, see AWS Services That
Work with IAM in the IAM User Guide.

Topics


Amazon ECR Identity-Based Policies
Amazon ECR Resource-Based Policies
Authorization Based on Amazon ECR Tags
Amazon ECR IAM Roles


Amazon ECR Identity-Based Policies

With IAM identity-based policies, you can specify allowed or denied actions
and resources as well as the conditions under which actions are allowed or
denied. Amazon ECR supports specific actions, resources, and condition keys.
To learn about all of the elements that you use in a JSON policy, see IAM
JSON Policy Elements Reference in the IAM User Guide.

Actions

The Action element of an IAM identity-based policy describes the specific
action or actions that will be allowed or denied by the policy. Policy
actions usually have the same name as the associated AWS API operation. The
action is used in a policy to grant permissions to perform the associated
operation.

Policy actions in Amazon ECR use the following prefix before the action:
ecr:. For example, to grant someone permission to create an Amazon ECR
repository with the Amazon ECR CreateRepository API operation, you include
the ecr:CreateRepository action in their policy. Policy statements must
include either an Action or NotAction element. Amazon ECR defines its own set
of actions that describe tasks that you can perform with this service. To
specify multiple actions in a single statement, separate them with commas as
follows: "Action": [ "ecr:action1", "ecr:action2" You can specify
multiple actions using wildcards (*). For example, to specify all
actions that begin with the word Describe, include the following action:
"Action": "ecr:Describe*" To see a list of Amazon ECR actions, see
Actions, Resources, and Condition Keys for Amazon Elastic Container
Registry in the IAM User Guide.

Resources

The Resource element specifies the object or objects to which the action
applies. Statements must include either a Resource or a NotResource element.
You specify a resource using an ARN or using the wildcard (*) to
indicate that the statement applies to all resources.

An Amazon ECR repository resource has the following ARN:
arn:${Partition}:ecr:${Region}:${Account}:repository/${Repository-name}
For more information about the format of ARNs, see Amazon Resource Names
(ARNs) and AWS Service Namespaces.
For example, to specify the my-repo repository in the us-east-1 Region in
your statement, use the following ARN:
"Resource": "arn:aws:ecr:us-east-1:123456789012:repository/my-repo"
To specify all repositories that belong to a specific account, use the
wildcard (*): "Resource":
"arn:aws:ecr:us-east-1:123456789012:repository/*"
To specify multiple resources in a single statement, separate the ARNs with
commas. "Resource": [ "resource1", "resource2"
To see a list of Amazon ECR resource types and their ARNs, see Resources
Defined by Amazon Elastic Container Registry in the IAM User Guide. To learn
with which actions you can specify the ARN of each resource, see Actions
Defined by Amazon Elastic Container Registry.

Condition Keys

The Condition element (or Condition block) lets you specify conditions in
which a statement is in effect. The Condition element is optional. You can
build conditional expressions that use condition operators, such as equals or
less than, to match the condition in the policy with values in the request.
If you specify multiple Condition elements in a statement, or multiple keys
in a single Condition element, AWS evaluates them using a logical AND
operation. If you specify multiple values for a single condition key, AWS
evaluates the condition using a logical OR operation. All of the conditions
must be met before the statement's permissions are granted.
You can also use placeholder variables when you specify conditions. For
example, you can grant an IAM user permission to access a resource only if it
is tagged with their IAM user name. For more information, see IAM Policy
Elements: Variables and Tags in the IAM User Guide.
Amazon ECR defines its own set of condition keys and also supports using some global
condition keys. To see all AWS global condition keys, see AWS Global Condition Context
Keys in the IAM User Guide.
Most Amazon ECR actions support the aws:ResourceTag and ecr:ResourceTag
condition keys. For more information, see Using Tag-Based Access Control. To
see a list of Amazon ECR condition keys, see Condition Keys Defined by Amazon
Elastic Container Registry in the IAM User Guide. To learn with which actions
and resources you can use a condition key, see Actions Defined by Amazon
Elastic Container Registry.
      Is it the case that access to the container image registry is restricted?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-file_owner_worker_kubeconfig_question:question:1">
          <ocil:question_text>To check the ownership of /var/lib/kubelet/kubeconfig,
run the command:
$ ls -lL /var/lib/kubelet/kubeconfig
If properly configured, the output should indicate the following owner:
root
      Is it the case that /var/lib/kubelet/kubeconfig does not have an owner of root?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_anonymous_auth_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep -A1 anonymous; done
The output should return enabled: false.
      Is it the case that &lt;tt&gt;anonymous&lt;/tt&gt; authentication is not set to &lt;tt&gt;false&lt;/tt&gt;?
      </ocil:question_text>
        </ocil:boolean_question>
        <ocil:boolean_question id="ocil:ssg-kubelet_enable_client_cert_rotation_question:question:1">
          <ocil:question_text>Run the following command on the kubelet node(s):
$ for NODE_NAME in $(oc get nodes -ojsonpath='{.items[*].metadata.name}'); do oc get --raw /api/v1/nodes/$NODE_NAME/proxy/configz | jq '.kubeletconfig|.kind="KubeletConfiguration"|.apiVersion="kubelet.config.k8s.io/v1beta1"' | grep RotateKubeletClientCertificate; done
The output should return nothing or true.
      Is it the case that the kubelet cannot rotate client certificate?
      </ocil:question_text>
        </ocil:boolean_question>
      </ocil:questions>
    </ocil:ocil>
  </ds:component>
  <ds:component id="scap_org.open-scap_comp_ssg-eks-cpe-oval.xml" timestamp="2024-05-16T18:06:55">
    <oval-def:oval_definitions xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd  http://oval.mitre.org/XMLSchema/oval-definitions-5#linux linux-definitions-schema.xsd">
      <oval-def:generator>
        <oval:product_name>build_cpe.py from SCAP Security Guide</oval:product_name>
        <oval:product_version>ssg: [0, 1, 73], python: 3.12.3</oval:product_version>
        <oval:schema_version>5.11</oval:schema_version>
        <oval:timestamp>2024-05-16T18:06:54</oval:timestamp>
      </oval-def:generator>
      <oval-def:definitions>
        <oval-def:definition id="oval:ssg-installed_app_is_eks:def:1" version="1" class="inventory">
          <oval-def:metadata>
            <oval-def:title>Amazon Elastic Kubernetes Service</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="cpe:/a:amazon:elastic_kubernetes_service:1" source="CPE"/>
            <oval-def:description>The application installed installed on the system is EKS.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="cluster is EKS" test_ref="oval:ssg-test_eks:tst:1"/>
            <oval-def:criterion comment="Make sure kubernetes version is present" test_ref="oval:ssg-test_file_for_eks:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-installed_app_is_eks_1_21:def:1" version="1" class="inventory">
          <oval-def:metadata>
            <oval-def:title>Amazon Elastic Kubernetes Service 1.21</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="cpe:/a:amazon:elastic_kubernetes_service:1.21" source="CPE"/>
            <oval-def:description>The application installed installed on the system is Amazon Elastic Kubernetes Service 1.21.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="cluster is EKS 1.21" test_ref="oval:ssg-test_eks_1_21:tst:1"/>
            <oval-def:criterion comment="Make sure kubernetes version is present" test_ref="oval:ssg-test_file_for_eks:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-installed_app_is_eks_node:def:1" version="1" class="inventory">
          <oval-def:metadata>
            <oval-def:title>Amazon Elastic Kubernetes Service Node</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="cpe:/o:amazon:elastic_kubernetes_service_node:1" source="CPE"/>
            <oval-def:description>The application installed installed on the system is EKS 4.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Kubelet is installed" test_ref="oval:ssg-test_kubelet_kubeconfig_exists:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
        <oval-def:definition id="oval:ssg-installed_app_is_ocp4_on_hypershift:def:1" version="1" class="inventory">
          <oval-def:metadata>
            <oval-def:title>Red Hat OpenShift Container Platform</oval-def:title>
            <oval-def:affected family="unix">
              <oval-def:platform>Amazon Elastic Kubernetes Service</oval-def:platform>
            </oval-def:affected>
            <oval-def:reference ref_id="cpe:/a:redhat:openshift_container_platform_on_hypershift:4" source="CPE"/>
            <oval-def:description>The application installed installed on the system is OpenShift 4 on HyperShift Management Cluster.</oval-def:description>
          </oval-def:metadata>
          <oval-def:criteria operator="AND">
            <oval-def:criterion comment="Make sure there is version for HyperShift HostedCluster" test_ref="oval:ssg-test_hypershift_version:tst:1"/>
          </oval-def:criteria>
        </oval-def:definition>
      </oval-def:definitions>
      <oval-def:tests>
        <ind:yamlfilecontent_test id="oval:ssg-test_eks:tst:1" version="1" check="at least one" comment="Find one match" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_eks:obj:1"/>
          <ind:state state_ref="oval:ssg-state_eks:ste:1"/>
        </ind:yamlfilecontent_test>
        <unix:file_test id="oval:ssg-test_file_for_eks:tst:1" version="1" check="only one" comment="Find the actual file to be scanned." state_operator="AND">
          <unix:object object_ref="oval:ssg-object_file_for_eks:obj:1"/>
        </unix:file_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_eks_1_21:tst:1" version="1" check="at least one" comment="Find one match" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_eks:obj:1"/>
          <ind:state state_ref="oval:ssg-state_eks_1_21:ste:1"/>
        </ind:yamlfilecontent_test>
        <unix:file_test id="oval:ssg-test_kubelet_kubeconfig_exists:tst:1" version="1" check="all" comment="Testing if /var/lib/kubelet/kubeconfig exists" check_existence="all_exist" state_operator="AND">
          <unix:object object_ref="oval:ssg-object_kubelet_kubeconfig_exists:obj:1"/>
        </unix:file_test>
        <ind:yamlfilecontent_test id="oval:ssg-test_hypershift_version:tst:1" version="1" check="at least one" comment="Find one match" state_operator="AND">
          <ind:object object_ref="oval:ssg-object_hypershift_version:obj:1"/>
          <ind:state state_ref="oval:ssg-state_hypershift_version:ste:1"/>
        </ind:yamlfilecontent_test>
      </oval-def:tests>
      <oval-def:objects>
        <unix:file_object id="oval:ssg-object_file_for_eks:obj:1" version="1">
          <unix:filepath var_ref="oval:ssg-eks_dump_location:var:1"/>
        </unix:file_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_eks:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-eks_dump_location:var:1"/>
          <ind:yamlpath>.gitVersion</ind:yamlpath>
        </ind:yamlfilecontent_object>
        <unix:file_object id="oval:ssg-object_kubelet_kubeconfig_exists:obj:1" version="1" comment="/var/lib/kubelet/kubeconfig">
          <unix:filepath>/var/lib/kubelet/kubeconfig</unix:filepath>
        </unix:file_object>
        <ind:yamlfilecontent_object id="oval:ssg-object_hypershift_version:obj:1" version="1">
          <ind:filepath var_ref="oval:ssg-ocp4_hypershift_dump_location:var:1"/>
          <ind:yamlpath>[:]</ind:yamlpath>
        </ind:yamlfilecontent_object>
      </oval-def:objects>
      <oval-def:states>
        <ind:yamlfilecontent_state id="oval:ssg-state_eks:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" datatype="string" operation="pattern match">^.*-eks-.*$</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_eks_1_21:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" datatype="string" operation="pattern match">^v1\.21\..*</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
        <ind:yamlfilecontent_state id="oval:ssg-state_hypershift_version:ste:1" version="1" operator="AND">
          <ind:value datatype="record">
            <oval-def:field name="#" datatype="string" operation="pattern match">4\..*</oval-def:field>
          </ind:value>
        </ind:yamlfilecontent_state>
      </oval-def:states>
      <oval-def:variables>
        <oval-def:local_variable id="oval:ssg-eks_dump_location:var:1" version="1" datatype="string" comment="The actual filepath of the file to scan.">
          <oval-def:literal_component>/kubernetes-api-resources/version</oval-def:literal_component>
        </oval-def:local_variable>
        <oval-def:local_variable id="oval:ssg-ocp4_hypershift_dump_location:var:1" version="1" datatype="string" comment="The actual filepath of the file to scan.">
          <oval-def:literal_component>/kubernetes-api-resources/hypershift/version</oval-def:literal_component>
        </oval-def:local_variable>
      </oval-def:variables>
    </oval-def:oval_definitions>
  </ds:component>
</ds:data-stream-collection>
